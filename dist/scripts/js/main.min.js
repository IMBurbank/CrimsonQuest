"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var enemyAvian={timidBat:{name:"Timid Bat",type:"avian",palette:["avian0Palette","avian1Palette"],iconLoc:[128,352],spawnQuant:{1:35},boss:!1,aggression:2,levelRange:[1,1],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},annoyedOwl:{name:"Annoyed Owl",type:"avian",palette:["avian0Palette","avian1Palette"],iconLoc:[32,320],spawnQuant:{1:25,2:35},boss:!1,aggression:2,levelRange:[1,2],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},bloodBat:{name:"Blood Bat",type:"avian",palette:["avian0Palette","avian1Palette"],iconLoc:[64,352],spawnQuant:{3:25,4:35},boss:!1,aggression:3,levelRange:[4,5],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},deathHawk:{name:"Death Hawk",type:"avian",palette:["avian0Palette","avian1Palette"],iconLoc:[32,32],spawnQuant:{5:20,6:35},boss:!1,aggression:4,levelRange:[6,7],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},bloodBeak:{name:"Blood Beak",type:"avian",palette:["avian0Palette","avian1Palette"],iconLoc:[160,96],spawnQuant:{7:20,8:35},boss:!1,aggression:4,levelRange:[7,8],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}}},enemyDemon={deviousImp:{name:"Devious Imp",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[64,128],spawnQuant:{4:20,5:30},boss:!1,aggression:3,levelRange:[5,6],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},chupacabra:{name:"Chupacabra",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[0,256],spawnQuant:{6:25,7:30},boss:!1,aggression:3,levelRange:[5,6],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},vileSuccubus:{name:"Vile Succubus",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[0,224],spawnQuant:{7:20,8:30},boss:!1,aggression:4,levelRange:[7,8],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},abyssHound:{name:"Vile Succubus",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[160,0],spawnQuant:{8:20,9:30},boss:!1,aggression:4,levelRange:[8,9],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},demonGuard:{name:"Demon Guard",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[32,32],spawnQuant:{9:20,10:30},boss:!1,aggression:5,levelRange:[9,10],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},abyssCambion:{name:"Abyss Cambion",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[192,64],spawnQuant:{10:25},boss:!1,aggression:5,levelRange:[10,11],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},agares:{name:"Agares",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[224,32],spawnQuant:{6:1},boss:!0,aggression:3,levelRange:[10,10],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},asmodius:{name:"Asmodius",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[128,32],spawnQuant:{7:1},boss:!0,aggression:4,levelRange:[12,12],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},belphagor:{name:"Belphagor",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[192,0],spawnQuant:{8:1},boss:!0,aggression:5,levelRange:[13,13],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},astaroth:{name:"Astaroth",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[192,32],spawnQuant:{9:1},boss:!0,aggression:5,levelRange:[15,15],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},azazel:{name:"Azazel",type:"demon",palette:["demon0Palette","demon1Palette"],iconLoc:[96,32],spawnQuant:{10:1},boss:!0,aggression:5,levelRange:[17,17],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}}},enemyElemental={sandElemental:{name:"Sand Elemental",type:"elemental",palette:["elemental0Palette","elemental1Palette"],iconLoc:[0,32],spawnQuant:{3:20,4:35},boss:!1,aggression:3,levelRange:[3,4],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},fireElemental:{name:"Fire Elemental",type:"elemental",palette:["elemental0Palette","elemental1Palette"],iconLoc:[64,160],spawnQuant:{5:20,6:35},boss:!1,aggression:4,levelRange:[5,7],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}}},enemyHumanoid={eliTheTraitor:{name:"Eli the Traitor",type:"humanoid",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[160,192],spawnQuant:{1:1},boss:!0,aggression:3,levelRange:[3,3],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},borisTheButcher:{name:"Boris the Butcher",type:"humanoid",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[0,0],spawnQuant:{2:1},boss:!0,aggression:3,levelRange:[5,5],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},phanxTheRaider:{name:"Phanx the Raider",type:"humanoid",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[32,64],spawnQuant:{3:1},boss:!0,aggression:3,levelRange:[6,6],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},quorakTheCannibal:{name:"Quorak the Cannibal",type:"humanoid",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[64,128],spawnQuant:{4:1},boss:!0,aggression:4,levelRange:[8,8],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},theDarkDisciple:{name:"The Dark Disciple",type:"humanoid",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[128,192],spawnQuant:{5:1},boss:!0,aggression:4,levelRange:[9,9],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},travelingMerchant:{name:"Traveling Merchant",type:"merchant",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[32,160],spawnQuant:{1:1},boss:!1,aggression:0,levelRange:[5,5],baseStats:{bHealth:10,bAttack:0,bDefense:150,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:0,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3},inventory:{}},outlawMerchant:{name:"Outlaw Merchant",type:"merchant",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[96,160],spawnQuant:{3:1},boss:!1,aggression:0,levelRange:[6,8],baseStats:{bHealth:10,bAttack:0,bDefense:150,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:0,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3},inventory:{}},seedyMerchant:{name:"Seedy Merchant",type:"merchant",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[64,160],spawnQuant:{5:1},boss:!1,aggression:0,levelRange:[8,8],baseStats:{bHealth:10,bAttack:0,bDefense:150,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:0,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3},inventory:{}},soullessMerchant:{name:"Soulless Merchant",type:"merchant",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[128,160],spawnQuant:{7:1},boss:!1,aggression:0,levelRange:[9,11],baseStats:{bHealth:10,bAttack:0,bDefense:150,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:0,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3},inventory:{}},darkMerchant:{name:"Dark Merchant",type:"merchant",palette:["humanoid0Palette","humanoid1Palette"],iconLoc:[160,160],spawnQuant:{9:1},boss:!1,aggression:0,levelRange:[12,12],baseStats:{bHealth:10,bAttack:0,bDefense:150,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:0,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3},inventory:{}}},enemyReptile={bloodSnake:{name:"Blood Snake",type:"reptile",palette:["reptile0Palette","reptile1Palette"],iconLoc:[96,128],spawnQuant:{1:10,2:25},boss:!1,aggression:3,levelRange:[2,3],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},wingedViper:{name:"Winged Viper",type:"reptile",palette:["reptile0Palette","reptile1Palette"],iconLoc:[96,0],spawnQuant:{2:15,3:25},boss:!1,aggression:3,levelRange:[2,4],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}},abyssDragon:{name:"Abyss Dragon",type:"reptile",palette:["reptile0Palette","reptile1Palette"],iconLoc:[96,128],spawnQuant:{10:20},boss:!1,aggression:4,levelRange:[10,11],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}}},enemyUndead={necromancer:{name:"Necromancer",type:"undead",palette:["undead0Palette","undead1Palette"],iconLoc:[0,160],spawnQuant:{9:25},boss:!1,aggression:4,levelRange:[8,10],baseStats:{bHealth:10,bAttack:4,bDefense:15,bHit:60,bCrit:5,bDodge:15,bVitality:2,bDurability:4,bStrength:5,bAgility:10},onLevelUp:{bHealth:6,bAttack:3,bDefense:4,bVitality:2,bDurability:2,bStrength:2,bAgility:3}}},randInt=function(e,t){return~~(e+Math.random()*(t-e+1))},devError=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Default Error";this.name="DevError",this.message=e,this.stack=(new Error).stack},initZeroArray=function(e){var t=[],a=0,n=0;for(t.length=e;a<e;){for(t[a]=[],t[a].length=e;n<e;)t[a][n]=0,n++;n=0,a++}return t},getById=function(e){return document.getElementById(e)},addClasses=function(e){if(getById(e)){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var r=getById(e).getAttribute("class").split(" ");([].concat(a)||[]).forEach(function(e){r.includes(e)||r.push(e)}),getById(e).setAttribute("class",r.join(" "))}else console.log("Didnt add class: "+e+". Couldnt find node.")},removeClasses=function(e){if(getById(e)){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var r=getById(e).getAttribute("class").split(" ");([].concat(a)||[]).forEach(function(e){r.includes(e)&&r.splice(r.indexOf(e),1)}),getById(e).setAttribute("class",r.join(" "))}else console.log("Didnt remove class: "+e+". Couldnt find node.")},initMemCanvas=function(e,t,a){var n=document.createElement("canvas"),r=n.getContext("2d");return n.width=e,n.height=t,r.imageSmoothingEnabled=a,n},linearDistance=function(e,t){return Math.sqrt(Math.pow(e[1]-t[1],2)+Math.pow(e[0]-t[0],2))},calcRenderPadding=function(e,t,a,n){var r=0,o=0,i=0,s=0,l=0,c=0,u=0,p=0;if(paddingCache[""+e]){var m=paddingCache[""+e];r=m.startRow,i=m.startCol,l=m.renderArrHeight,c=m.renderArrWidth,u=m.sX,p=m.sY}else e[0]-~~(a/2)<0?(r=0,o=-1*(e[0]-~~(a/2))):e[0]+~~(a/2)+1>t?(o=e[0]+~~(a/2)+1-t,r=t-a+o):(r=e[0]-~~(a/2),o=0),
e[1]-~~(a/2)<0?(i=0,s=-1*(e[1]-~~(a/2))):e[1]+~~(a/2)+1>t?(s=e[1]+~~(a/2)+1-t,i=t-a+s):(i=e[1]-~~(a/2),s=0),l=a-o,c=a-s,u=!i&&s?s*n:0,p=!r&&o?o*n:0,paddingCache[""+e]={startRow:r,startCol:i,renderArrHeight:l,renderArrWidth:c,sX:u,sY:p};return{startRow:r,startCol:i,renderArrHeight:l,renderArrWidth:c,sX:u,sY:p}},setRenderArr=function(e,t,a){var n=[],r=a.sr,o=a.sc,i=0,s=0,l=0,c=0;for(l=t-a.pr,c=t-a.pc,n.length=l;i<l;i++)for(n[i]=[],n[i].length,s=0,c;s<c;s++)n[i][s]=e[r+i][o+s];return n},backgroundArray=function(e){var t=function(e,t){var a=roomSize[t].min,n=roomSize[t].max,r=roomSize[e].min,o=roomSize[e].max,i=a-4,s=n-4,l=r-4,c=o-4,u=randInt(i,s),p=randInt(l,c),m=randInt(2,n-u-2),h=n-u-m,y=randInt(2,o-p-2),d=o-p-y,b=[],g=0,f=0;for(b.length=o,g=0;g<o;g++)for(b[g]=[],f=0;f<n;f++)b[g][f]=f+1>m&&f<m+u&&g+1>y&&g<y+p?40:10;return{xPadL:m,xPadR:h,yPadT:y,yPadB:d,xMax:n,yMax:o,roomFloorArr:b}},a=function(e,t){var a=roomSize[t].min,n=roomSize[t].max,r=roomSize[e].min,o=roomSize[e].max,i=a-4,s=r-4,l=randInt(2,n-i-2),c=n-i-l,u=randInt(2,o-s-2),p=o-s-u,m=[],h=[],y=0,d=0,b=0,g=0;for(h.length=4,b=0;b<4;b++)for(h[b]=[],0===b?(y=u-2,d=i):1===b?(y=c-2,d=s):2===b?(y=p-2,d=i):(y=l-2,d=s),g=0;g<d;g++)h[b][g]=randInt(0,y);for(m.length=o,b=0;b<o;b++)for(m[b]=[],g=0;g<n;g++)m[b][g]=g+1>l&&g<l+i&&b+1>u&&b<u+s?40:10;return h[0].forEach(function(e,t){for(b=0;b<e;b++)m[u-1-b][l+t]=40}),h[1].forEach(function(e,t){for(b=0;b<e;b++)m[u+t][l+i+b]=40}),h[2].forEach(function(e,t){for(b=0;b<e;b++)m[u+s+b][l+t]=40}),h[3].forEach(function(e,t){for(b=0;b<e;b++)m[u+t][l-1-b]=40}),u-=Math.max.apply(Math,_toConsumableArray(h[0])),c-=Math.max.apply(Math,_toConsumableArray(h[1])),p-=Math.max.apply(Math,_toConsumableArray(h[2])),l-=Math.max.apply(Math,_toConsumableArray(h[3])),{xPadL:l,xPadR:c,yPadT:u,yPadB:p,xMax:n,yMax:o,roomFloorArr:m}},n=function(e,t){var a=roomSize[t].min,n=roomSize[t].max,r=roomSize[e].min,o=roomSize[e].max,i=n-4,s=a-4,l=o-4,c=r-4,u=randInt(s,i),p=randInt(c,l),m=[randInt(0,1),randInt(0,1),randInt(0,1),randInt(0,1)],h=randInt(2,n-u-2),y=n-u-h,d=randInt(2,o-p-2),b=o-p-d,g=[],f=[],v=0,w=0,A=0,C=0;for(f.length=4,A=0;A<4;A++)for(f[A]=[],0===A?(v=d-2,w=u):1===A?(v=y-2,w=p):2===A?(v=b-2,w=u):(v=h-2,w=p),C=0;C<w;C++)f[A][C]=randInt(0,v);for(g.length=o,A=0;A<o;A++)for(g[A]=[],C=0;C<n;C++)g[A][C]=C+1>h&&C<h+u&&A+1>d&&A<d+p?40:10;return m[0]&&f[0].forEach(function(e,t){for(A=0;A<e;A++)g[d-1-A][h+t]=40}),m[1]&&f[1].forEach(function(e,t){for(A=0;A<e;A++)g[d+t][h+u+A]=40}),m[2]&&f[2].forEach(function(e,t){for(A=0;A<e;A++)g[d+p+A][h+t]=40}),m[3]&&f[3].forEach(function(e,t){for(A=0;A<e;A++)g[d+t][h-1-A]=40}),d=m[0]?d-Math.max.apply(Math,_toConsumableArray(f[0])):d,y=m[1]?y-Math.max.apply(Math,_toConsumableArray(f[1])):y,b=m[2]?b-Math.max.apply(Math,_toConsumableArray(f[2])):b,h=m[3]?h-Math.max.apply(Math,_toConsumableArray(f[3])):h,{xPadL:h,xPadR:y,yPadT:d,yPadB:b,xMax:n,yMax:o,roomFloorArr:g}},r=function(e,t,a,n,r,o,i){var s=a.length,l=e.xMax,c=e.yMax,u=[],p=[],m=!1,h=!1,y=!1,d=!1,b=!1,g=0,f=0,v=0,w=0;if(1===o||2===o&&e.cnxns[3]||4===o&&e.cnxns[0]?(g=randInt(1,3),h=1===g||3===g,y=2===g||3===g):2===o?(h=!!randInt(0,1),y=!0):3===o?y=!(e.cnxns[3]&&i&&!randInt(0,1)):4===o?(h=!0,y=!!randInt(0,1)):5===o?h=!(e.cnxns[0]&&t[e.curRow-1][~~(r/t[e.curRow-1][0].xMax)].cnxns[1]&&!randInt(0,1)):(m=!e.cnxns[0],d=!e.cnxns[3]),i=!!y||i,e.yMax-e.yPadT-e.yPadB<14&&!h&&[1,2,4,5].includes(o)&&(h=!0,o>2&&(m=!0),r>15&&(d=!0)),e.xMax-e.xPadL-e.xPadR<14&&(o>3&&(m=!0),o<5&&(y=!0),r>15&&(d=!0)),m){for(f=0;f<l;){if(40===a[n][r-~~(l/2)+f]){for(w=r-~~(l/2)+f,b=!1,v=0;!b;)++v>~~(c/2)&&(v>2*c||n-v<2||40===a[n-v][w]||40===a[n-v-1][w]||40===a[n-v][w+1]||40===a[n-v][w-1])&&(b=!0);v<2*c&&n-v>1&&u.push([1,w,n,v])}f++}u.length>0?p.push(u[randInt(0,u.length-1)]):(3===o&&6===o||(h=!0),o>2&&(y=!0))}if(y){for(u.length=0,f=0;f<l;){if(40===a[n][r-~~(l/2)+f]){for(w=r-~~(l/2)+f,b=!1,v=0;!b;)++v>~~(c/2)&&(v>2*c||n+v>s-3||40===a[n+v][w]||40===a[n+v][w+1]||40===a[n+v+1][w]||40===a[n+v][w-1])&&(b=!0);v<2*c&&n+v<s-3&&u.push([3,w,n,v])}f++}u.length>0?p.push(u[randInt(0,u.length-1)]):(3===o&&6===o||(h=!0),r>15&&(d=!0))}if(h){for(u.length=0,f=0;f<c;){if(40===a[n-~~(c/2)+f][r]){for(w=n-~~(c/2)+f,b=!1,v=0;!b;)++v>~~(l/2)&&(v>2*l||r+v>s-3||40===a[w][r+v]||40===a[w-1][r+v]||40===a[w][r+v+1]||40===a[w+1][r+v])&&(b=!0);v<2*l&&r+v<s-3&&u.push([2,r,w,v])}f++}u.length>0?p.push(u[randInt(0,u.length-1)]):r>15&&(d=!0)}if(d){for(u.length=0,f=0;f<c;){if(40===a[n-~~(c/2)+f][r]){for(w=n-~~(c/2)+f,b=!1,v=0;!b;)++v>~~(c/2)&&(v>2*l||r-v<2||40===a[w][r-v]||40===a[w-1][r-v]||40===a[w+1][r-v]||40===a[w][r-v-1])&&(b=!0);v<2*l&&r-v>1&&u.push([4,r,w,v])}f++}u.length>0&&p.push(u[randInt(0,u.length-1)])}return{paths:p,tiedRow:i}},o=function(e,t,a,n){var r=0;return n.forEach(function(n){if(1===n[0]){for(r=0;r<n[3];)r++,a[n[2]-r][n[1]]=40;e.cnxns[0]=1,t[e.curRow-1][~~(n[1]/t[e.curRow-1][0].xMax)].cnxns[2]=1}else if(2===n[0]){for(r=0;r<n[3];)r++,a[n[2]][n[1]+r]=40;e.cnxns[1]=1,t[e.curRow][1+~~(n[1]/t[e.curRow][0].xMax)].cnxns[3]=1}else if(3===n[0]){for(r=0;r<n[3];)r++,a[n[2]+r][n[1]]=40;e.cnxns[2]=1,t[e.curRow+1][~~(n[1]/t[e.curRow+1][0].xMax)].cnxns[0]=1}else if(4===n[0]){for(r=0;r<n[3];)r++,a[n[2]][n[1]-r]=40;e.cnxns[3]=1,t[e.curRow][~~(n[1]/t[e.curRow][0].xMax)-1].cnxns[1]=1}}),!0},i=function(){var e=0,r=[],o=0,i=0,s=0,l=0,c=0,u=0,p=0,m=0,h=[],y=[],d=0,b=0;for(e=2*randInt(3,4),r.length=e;d<e;d++)r[d]=2*randInt(2,4);return r.map(function(r,d){for(h=[],b=0;b<r;b++){if(m=randInt(1,10),o=r,1===m){var g=t(e,o);i=g.xPadL,s=g.xPadR,l=g.yPadT,c=g.yPadB,u=g.xMax,p=g.yMax,y=g.roomFloorArr}else if(m>1&&m<8){var f=a(e,o);i=f.xPadL,s=f.xPadR,l=f.yPadT,c=f.yPadB,u=f.xMax,p=f.yMax,y=f.roomFloorArr}else{var v=n(e,o);i=v.xPadL,s=v.xPadR,l=v.yPadT,c=v.yPadB,u=v.xMax,p=v.yMax,y=v.roomFloorArr}h[b]={rows:e,cols:o,xPadL:i,xPadR:s,yPadT:l,yPadB:c,xMax:u,yMax:p,roomFloorArr:y,cnxns:[0,0,0,0],curRow:d}}return h})}(),s=function(t){var a=[],n=e,r=0,o=0,i=0,s=0,l=0;for(a.length=n;l<n;){for(;r<n;)a[l]=0===r?t[s][o].roomFloorArr[i]:[].concat(_toConsumableArray(a[l]),_toConsumableArray(t[s][o].roomFloorArr[i])),r+=t[s][o].xMax,o++;i===t[s][o-1].yMax-1?(i=0,s++):i++,r=0,o=0,l++}return a}(i),l=function(e,t){var a=t.length,n=!1,i=[],s=void 0,l=0,c=0,u=0,p=0,m=0,h=0,y=0;for(i.length=~~(a/4);p<a;){for(;m<a;){s=e[y][h],l=p+~~(s.yMax/2),c=m+~~(s.xMax/2),u=0===y&&0===h?1:0===y&&h<e[y].length-1?2:y<e.length-1&&h===e[y].length-1?3:y<e.length-1&&h<e[y].length-1?4:y===e.length-1&&h<e[y].length-1?5:6;var d=r(s,e,t,l,c,u,n);i=d.paths,n=d.tiedRow,o(s,e,t,i),m+=s.xMax,h++}p+=e[y][h-1].yMax,y++,n=!1,m=0,h=0}return t}(i,s),c=function(e){var t=e.length,a=randInt(1,4),n=[],r=0,o=0,i=function(e){for(var t=[],a=e.length;r<a;){for(t[r]=[],o=0;o<a;)t[r][o]=e[o][r],o++;r++}return t};if(1===a&&(n=[].concat(_toConsumableArray(e))),2===a)n=i(e),n.forEach(function(e){return e.reverse()});else if(3===a)for(;r<t;)n[r]=e[t-1-r].reverse(),r++;else 4===a&&(e.forEach(function(e){return e.reverse()}),n=i(e));return{orientation:a,orientedArr:n}}(l),u=(c.orientation,c.orientedArr),p=function(e){for(var t=e,a=[0,0,0,0,0,0,0,0],n=t.length-1,r=1,o=1,i=0;r<n;){for(o=1;o<n;)i=0,10===e[r][o]&&(a[0]=t[r-1][o-1],a[1]=t[r-1][o],a[2]=t[r-1][o+1],a[3]=t[r][o-1],a[4]=t[r][o+1],a[5]=t[r+1][o-1],a[6]=t[r+1][o],a[7]=t[r+1][o+1],a.includes(40)&&(a[3]>10&&a[3]<40&&10===a[4]&&10===a[6]&&(10===a[1]||40===a[1])&&(40===a[5]&&40===a[7]||40===a[1]&&(40===a[5]||40===a[7]))?i=31:a[1]>10&&a[1]<40&&10===a[4]&&10===a[6]&&(40===a[2]&&40===a[7]||40===a[3]&&(40===a[2]||40===a[7]))?i=32:a[1]>10&&a[1]<40&&a[3]>10&&a[3]<40&&10===a[4]&&10===a[6]&&40===a[2]&&40===a[7]?i=33:a[1]>10&&a[1]<40&&a[3]>10&&a[3]<40&&10===a[6]&&(40===a[0]&&40===a[5]||(40===a[0]||40===a[5])&&40===a[4])?i=34:a[1]>10&&a[1]<40&&a[3]>10&&a[3]<40&&10===a[4]&&(40===a[0]&&40===a[2]||(40===a[0]||40===a[2])&&40===a[6])?i=35:10===a[4]&&10===a[6]&&(40===a[1]&&40===a[3]||40===a[7])?i=21:a[3]>10&&a[3]<40&&10===a[6]&&(40===a[1]&&40===a[4]||40===a[5])?i=23:a[1]>10&&a[1]<40&&10===a[4]&&(40===a[3]&&40===a[6]||40===a[2])?i=25:a[1]>10&&a[1]<40&&a[3]>10&&a[3]<40&&(40===a[0]||40===a[4]&&40===a[6])?i=27:a[3]>10&&a[3]<40&&(40===a[1]||40===a[6])||10===a[4]&&(40===a[1]&&40===a[2]||40===a[5]&&40===a[6])?i=22:a[1]>10&&a[1]<40||10===a[6]&&(40===a[3]||40===a[4])?i=24:40!==a[1]&&40!==a[3]&&40!==a[4]&&40!==a[6]||(i=26),i&&(t[r][o]=i))),o++;r++}return t}(u),m=function(e){for(var t=e,a=[0,0,0,0,0,0,0,0],n=t.length-1,r=[],o=1,i=1,s=0;o<n;){for(i=1;i<n;)s=0,e[o][i]>39&&(a[0]=t[o-1][i-1],a[1]=t[o-1][i],a[2]=t[o-1][i+1],a[3]=t[o][i-1],a[4]=t[o][i+1],a[5]=t[o+1][i-1],a[6]=t[o+1][i],a[7]=t[o+1][i+1],r.push([o,i]),a[1]<40&&a[3]<40&&a[4]>39&&a[6]>39?s=41:a[1]<40&&a[3]>39&&a[4]>39&&a[6]>39?s=42:a[1]<40&&a[3]>39&&a[4]<40&&a[6]>39?s=43:a[1]>39&&a[3]<40&&a[4]>39&&a[6]>39?s=44:a[1]>39&&a[3]>39&&a[4]>39&&a[6]>39?s=45:a[1]>39&&a[3]>39&&a[4]<40&&a[6]>39?s=46:a[1]>39&&a[3]<40&&a[4]>39&&a[6]<40?s=47:a[1]>39&&a[3]>39&&a[4]>39&&a[6]<40?s=48:a[1]>39&&a[3]>39&&a[4]<40&&a[6]<40?s=49:a[1]<40&&a[3]<40&&a[4]<40&&a[6]>39?s=51:a[1]>39&&a[3]<40&&a[4]<40&&a[6]>39?s=52:a[1]>39&&a[3]<40&&a[4]<40&&a[6]<40?s=53:a[1]<40&&a[3]<40&&a[4]>39&&a[6]<40?s=54:a[1]<40&&a[3]>39&&a[4]>39&&a[6]<40?s=55:a[1]<40&&a[3]>39&&a[4]<40&&a[6]<40?s=56:a[1]<40&&a[3]<40&&a[4]<40&&a[6]<40&&(s=57),s&&(t[o][i]=s)),i++;o++}return{bgArr:t,floorCoords:r}}(p);return{bgArr:m.bgArr,floorCoords:m.floorCoords}},timeRef=null,paddingCache={},roomSize={4:{min:16,max:30},6:{min:14,max:20},8:{min:11,max:15}},consumableAbbrevMap={potion:{name:"Potion",key:"potion",abbrev:"LPOT",num:1},hiPotion:{name:"Hi Potion",key:"hiPotion",abbrev:"HPOT",num:2},xPotion:{name:"X Potion",key:"xPotion",abbrev:"XPOT",num:3},tomeOfVitality:{name:"Tome of Vitality",key:"tomeOfVitality",abbrev:"VTOM",num:4},tomeOfDurability:{name:"Tome of Durability",key:"tomeOfDurability",abbrev:"DTOM",num:5},tomeOfStrength:{name:"Tome of Strength",key:"tomeOfStrength",abbrev:"STOM",num:6},tomeOfAgility:{name:"Tome of Agility",key:"tomeOfAgility",abbrev:"ATOM",num:7},tomeOfWisdom:{name:"Tome of Wisdom",key:"tomeOfWisdom",abbrev:"WTOM",num:8}},equipAbbrevMap={Head:"HED",Amulet:"AMU",Weapon:"WEP",Armor:"AMR",Shield:"SLD",Glove:"GLV",Ring:"RNG",Foot:"FT",Consumable:"CNS"},statConvertWordMap={curHealth:"HP",iAttack:"Atk",iDefense:"Def",iVitality:"Vit",iDurability:"Dur",iStrength:"Str",iAgility:"Agi"},statConversion={vitToHp:9,durToHp:3,durToDef:2,durToDodge:.1,strToAtk:2,strToDef:1,strToHit:.25,agiToHit:1,agiToDodge:.5,agiToCrit:.5,atkToHpRange:[3,5],defToHpRange:[1,3],lvlToExpRange:[6,9],lvlToGoldRange:[1,3],expLevelMult:1.75,lvlUpSkillPoints:2,bossMultiplier:2.5},heroTypeStats={Mage:{heroName:"Forsyth",health:53,attack:12,defense:10,hit:90,crit:5,dodge:10,vitality:12,durability:10,strength:12,agility:10,onLevelUp:{health:0,attack:5,defense:0,vitality:1,durability:0,strength:2,agility:1},description:"Not your usual paper tiger. Devasting attack and high vitality."},Paladin:{heroName:"Roland",health:53,attack:10,defense:12,hit:90,crit:5,dodge:10,vitality:11,durability:11,strength:11,agility:11,onLevelUp:{health:6,attack:1,defense:2,vitality:1,durability:2,strength:1,agility:0},description:"Keeper of the faith. Very durable. Not terribly agile."},Rogue:{heroName:"Hanzo",health:50,attack:13,defense:10,hit:90,crit:5,dodge:10,vitality:10,durability:10,strength:12,agility:12,onLevelUp:{health:6,attack:3,defense:0,vitality:0,durability:0,strength:2,agility:2},description:"Fierce. Deadly. Agile. Just don't get hit."},Warrior:{heroName:"Agis",health:50,attack:12,defense:11,hit:90,crit:5,dodge:10,vitality:10,durability:12,strength:12,agility:10,onLevelUp:{health:6,attack:2,defense:1,vitality:0,durability:1,strength:2,agility:1},description:"Well-rounded. Fierce. Fairly agile. You don't need health if your enemy is dead."}},merchantInventories={travelingMerchant:{Potion:{name:"Potion",type:"consumable",count:5,equipped:!1,itemArrVal:200,palette:"potionPalette",iconLoc:[0,0,32,32],buy:20,sell:10,stats:{curHealth:50},spawnQuant:{1:2,2:3,3:3,4:2,5:1}},"Cracked Ancient Amulet":{name:"Cracked Ancient Amulet",type:"amulet",count:1,equipped:!1,palette:"amuletPalette",iconLoc:[160,32,32,32],buy:120,sell:60,stats:{iDurability:2,iAgility:2},spawnQuant:{}}},outlawMerchant:{Potion:{name:"Potion",type:"consumable",count:4,equipped:!1,itemArrVal:200,palette:"potionPalette",iconLoc:[0,0,32,32],buy:20,sell:10,stats:{curHealth:50},spawnQuant:{1:2,2:3,3:3,4:2,5:1}},"Hi Potion":{name:"Hi Potion",type:"consumable",count:4,equipped:!1,itemArrVal:201,palette:"potionPalette",iconLoc:[64,0,32,32],buy:50,sell:25,stats:{curHealth:150},spawnQuant:{4:1,5:1,6:2,7:3,8:2,9:2,10:2}},"Tome of Wisdom":{name:"Tome of Wisdom",type:"consumable",count:1,equipped:!1,itemArrVal:207,palette:"bookPalette",iconLoc:[0,160,32,32],buy:200,sell:100,stats:{statPoints:1},spawnQuant:{4:1,6:1,8:1,10:1}}},seedyMerchant:{Potion:{name:"Potion",type:"consumable",count:5,equipped:!1,itemArrVal:200,palette:"potionPalette",iconLoc:[0,0,32,32],buy:20,sell:10,stats:{curHealth:50},spawnQuant:{1:2,2:3,3:3,4:2,5:1}},"Hi Potion":{name:"Hi Potion",type:"consumable",count:5,equipped:!1,itemArrVal:201,palette:"potionPalette",iconLoc:[64,0,32,32],buy:50,sell:25,stats:{curHealth:150},spawnQuant:{4:1,5:1,6:2,7:3,8:2,9:2,10:2}},"Tome of Vitality":{name:"Tome of Vitality",type:"consumable",count:1,equipped:!1,itemArrVal:203,palette:"bookPalette",iconLoc:[192,160,32,32],buy:100,sell:50,stats:{iVitality:1},spawnQuant:{3:1,6:1,9:1}},"Tome of Durability":{name:"Tome of Durability",type:"consumable",count:1,equipped:!1,itemArrVal:204,palette:"bookPalette",iconLoc:[192,192,32,32],buy:100,sell:50,stats:{iDurability:1},spawnQuant:{2:1,5:1,8:1}},"Tome of Strength":{name:"Tome of Strength",type:"consumable",count:1,equipped:!1,itemArrVal:205,palette:"bookPalette",iconLoc:[0,224,32,32],buy:100,sell:50,stats:{iStrength:1},spawnQuant:{1:1,4:1,8:1}},"Tome of Agility":{name:"Tome of Agility",type:"consumable",count:1,equipped:!1,itemArrVal:206,palette:"bookPalette",iconLoc:[64,224,32,32],buy:100,sell:50,stats:{iAgility:1},spawnQuant:{2:1,5:1,9:1}},"Tome of Wisdom":{name:"Tome of Wisdom",type:"consumable",count:1,equipped:!1,itemArrVal:207,palette:"bookPalette",iconLoc:[0,160,32,32],buy:200,sell:100,stats:{statPoints:1},spawnQuant:{4:1,6:1,8:1,10:1}},"Dark Ring":{name:"Dark Ring",type:"ring",count:1,equipped:!1,palette:"ringPalette",iconLoc:[128,96,32,32],buy:200,sell:100,stats:{iStrength:2,iAgility:2},spawnQuant:{}}},soullessMerchant:{"Hi Potion":{name:"Hi Potion",type:"consumable",count:5,equipped:!1,itemArrVal:201,palette:"potionPalette",iconLoc:[64,0,32,32],buy:50,sell:25,stats:{curHealth:150},spawnQuant:{4:1,5:1,6:2,7:3,8:2,9:2,10:2}},"X Potion":{name:"X Potion",type:"consumable",count:1,equipped:!1,itemArrVal:202,palette:"potionPalette",iconLoc:[96,64,32,32],buy:150,sell:75,stats:{curHealth:500},spawnQuant:{10:1}},"Tome of Wisdom":{name:"Tome of Wisdom",type:"consumable",count:3,equipped:!1,itemArrVal:207,palette:"bookPalette",iconLoc:[0,160,32,32],buy:200,sell:100,stats:{statPoints:1},spawnQuant:{4:1,6:1,8:1,10:1}},"Dark Glowing Ring":{name:"Dark Glowing Ring",type:"ring",count:1,equipped:!1,palette:"ringPalette",iconLoc:[32,128,32,32],buy:400,sell:200,stats:{iStrength:4,iAgility:3},spawnQuant:{}}},darkMerchant:{"Hi Potion":{name:"Hi Potion",type:"consumable",count:5,equipped:!1,itemArrVal:201,palette:"potionPalette",iconLoc:[64,0,32,32],buy:50,sell:25,stats:{curHealth:150},spawnQuant:{4:1,5:1,6:2,7:3,8:2,9:2,10:2}},"X Potion":{name:"X Potion",type:"consumable",count:5,equipped:!1,itemArrVal:202,palette:"potionPalette",iconLoc:[96,64,32,32],buy:150,sell:75,stats:{curHealth:500},spawnQuant:{10:1}},"Tome of Vitality":{name:"Tome of Vitality",type:"consumable",count:1,equipped:!1,itemArrVal:203,palette:"bookPalette",iconLoc:[192,160,32,32],buy:100,sell:50,stats:{iVitality:1},spawnQuant:{3:1,6:1,9:1}},"Tome of Durability":{name:"Tome of Durability",type:"consumable",count:1,equipped:!1,itemArrVal:204,palette:"bookPalette",iconLoc:[192,192,32,32],buy:100,sell:50,stats:{iDurability:1},spawnQuant:{2:1,5:1,8:1}},"Tome of Strength":{name:"Tome of Strength",type:"consumable",count:1,equipped:!1,itemArrVal:205,palette:"bookPalette",iconLoc:[0,224,32,32],buy:100,sell:50,stats:{iStrength:1},spawnQuant:{1:1,4:1,8:1}},"Tome of Agility":{name:"Tome of Agility",type:"consumable",count:1,equipped:!1,itemArrVal:206,palette:"bookPalette",iconLoc:[64,224,32,32],buy:100,sell:50,stats:{iAgility:1},spawnQuant:{2:1,5:1,9:1}},"Tome of Wisdom":{name:"Tome of Wisdom",type:"consumable",count:2,equipped:!1,itemArrVal:207,palette:"bookPalette",iconLoc:[0,160,32,32],buy:200,sell:100,stats:{statPoints:1},spawnQuant:{4:1,6:1,8:1,10:1}},"Dark Amulet":{name:"Dark Amulet",type:"amulet",count:1,equipped:!1,palette:"amuletPalette",iconLoc:[128,32,32,32],buy:400,sell:200,stats:{iStrength:5,iAgility:4},spawnQuant:{}}}},itemConsumables={potion:{name:"Potion",type:"consumable",palette:"potionPalette",iconLoc:[0,0,32,32],buy:20,sell:10,stats:{curHealth:50},spawnQuant:{1:2,2:3,3:3,4:2,5:1}},hiPotion:{name:"Hi Potion",type:"consumable",palette:"potionPalette",iconLoc:[64,0,32,32],buy:50,sell:25,stats:{curHealth:150},spawnQuant:{4:1,5:1,6:2,7:3,8:2,9:2,10:2}},xPotion:{name:"X Potion",type:"consumable",palette:"potionPalette",iconLoc:[96,64,32,32],buy:150,sell:75,stats:{curHealth:500},spawnQuant:{10:1}},tomeOfVitality:{name:"Tome of Vitality",type:"consumable",palette:"bookPalette",iconLoc:[192,160,32,32],buy:100,sell:50,stats:{iVitality:1},spawnQuant:{3:1,6:1,9:1}},tomeOfDurability:{name:"Tome of Durability",type:"consumable",palette:"bookPalette",iconLoc:[192,192,32,32],buy:100,sell:50,stats:{iDurability:1},spawnQuant:{2:1,5:1,8:1}},tomeOfStrength:{name:"Tome of Strength",type:"consumable",palette:"bookPalette",iconLoc:[0,224,32,32],buy:100,sell:50,stats:{iStrength:1},spawnQuant:{1:1,4:1,8:1}},tomeOfAgility:{name:"Tome of Agility",type:"consumable",palette:"bookPalette",iconLoc:[64,224,32,32],buy:100,sell:50,stats:{iAgility:1},spawnQuant:{2:1,5:1,9:1}},tomeOfWisdom:{name:"Tome of Wisdom",type:"consumable",palette:"bookPalette",iconLoc:[0,160,32,32],buy:200,sell:100,stats:{statPoints:1},spawnQuant:{4:1,6:1,8:1,10:1}},gold1:{name:"a little Gold",type:"gold",palette:"moneyPalette",iconLoc:[32,32,32,32],stats:{get gold(){return randInt(1,3)}},spawnQuant:{1:10,2:10,3:7,4:5,5:3}},gold2:{name:"some Gold",type:"gold",palette:"moneyPalette",iconLoc:[32,32,32,32],stats:{get gold(){return randInt(4,7)}},spawnQuant:{3:2,4:4,5:7,6:9,7:6,8:3,9:1}},gold3:{name:"a small pile of Gold",type:"gold",palette:"moneyPalette",iconLoc:[0,32,32,32],stats:{get gold(){return randInt(8,12)}},spawnQuant:{7:3,8:6,9:7,10:4}},gold4:{name:"a pile of Gold",type:"gold",palette:"moneyPalette",iconLoc:[0,32,32,32],stats:{get gold(){return randInt(13,17)}},spawnQuant:{9:2,10:6}}},chestConsumables={closedChest:{name:"Treasure Chest",type:"closedChest",palette:"chest0Palette",iconLoc:[32,0,32,32]},openChest:{name:"Treasure Chest",type:"openChest",palette:"chest1Palette",iconLoc:[32,0,32,32]},closedBarrel:{name:"Barrel",type:"closedChest",palette:"chest0Palette",iconLoc:[32,32,32,32]},openBarrel:{name:"Barrel",type:"openChest",palette:"chest1Palette",iconLoc:[32,32,32,32]}},itemAmulets={mageAmu1:{name:"Damaged Amulet of Striking",type:"amulet",palette:"amuletPalette",iconLoc:[32,0,32,32],buy:10,sell:5,stats:{iAttack:8},spawnQuant:{3:1}},mageAmu2:{name:"Amulet of Striking",type:"amulet",palette:"amuletPalette",iconLoc:[0,0,32,32],buy:30,sell:15,stats:{iAttack:12,iStrength:1},spawnQuant:{5:1}},mageAmu3:{name:"Enchanted Amulet of Striking",type:"amulet",palette:"amuletPalette",iconLoc:[64,0,32,32],buy:60,sell:30,stats:{iAttack:16,iStrength:2,iAgility:1},spawnQuant:{7:1}},rogueAmu1:{name:"Damaged Amulet of Stealth",type:"amulet",palette:"amuletPalette",iconLoc:[96,0,32,32],buy:10,sell:5,stats:{iAttack:4,iAgility:1},spawnQuant:{3:1}},rogueAmu2:{name:"Amulet of Stealth",type:"amulet",palette:"amuletPalette",iconLoc:[160,0,32,32],buy:30,sell:15,stats:{iAttack:4,iStrength:1,iAgility:2},spawnQuant:{5:1}},rogueAmu3:{name:"Enchanted Amulet of Stealth",type:"amulet",palette:"amuletPalette",iconLoc:[128,0,32,32],buy:60,sell:30,stats:{iAttack:8,iStrength:1,iAgility:4},spawnQuant:{7:1}},warriorAmu1:{name:"Damaged Amulet of Power",type:"amulet",palette:"amuletPalette",iconLoc:[224,0,32,32],buy:10,sell:5,stats:{iStrength:2},spawnQuant:{3:1}},warriorAmu2:{name:"Amulet of Power",type:"amulet",palette:"amuletPalette",iconLoc:[196,0,32,32],buy:30,sell:15,stats:{iStrength:2,iDurability:1},spawnQuant:{5:1}},warriorAmu3:{name:"Enchanted Amulet of Power",type:"amulet",palette:"amuletPalette",iconLoc:[0,32,32,32],buy:60,sell:30,stats:{iStrength:4,iDurability:2,iAgility:1},spawnQuant:{7:1}},paladinAmu1:{name:"Damaged Amulet of Life",type:"amulet",palette:"amuletPalette",iconLoc:[32,32,32,32],buy:10,sell:5,stats:{iVitality:2},spawnQuant:{3:1}},paladinAmu2:{name:"Amulet of Life",type:"amulet",palette:"amuletPalette",iconLoc:[96,32,32,32],buy:30,sell:15,stats:{iVitality:3,iDurabilty:1},spawnQuant:{5:1}},paladinAmu3:{name:"Enchanted Amulet of Life",type:"amulet",palette:"amuletPalette",iconLoc:[64,32,32,32],buy:60,sell:30,stats:{iVitality:4,iStrength:1,iDurabilty:2},spawnQuant:{7:1}},specialAmu1:{name:"Cracked Ancient Amulet",type:"amulet",palette:"amuletPalette",iconLoc:[160,32,32,32],buy:120,sell:60,stats:{iDurability:2,iAgility:2},spawnQuant:{}},specialAmu2:{name:"Dark Amulet",type:"amulet",palette:"amuletPalette",iconLoc:[128,32,32,32],buy:400,sell:200,stats:{iStrength:5,iAgility:4},spawnQuant:{}}},itemArmors={clothArm1:{name:"Moldy Robe",type:"armor",palette:"armorPalette",iconLoc:[0,128,32,32],buy:10,sell:5,stats:{iDefense:4,iVitality:1,iStrength:1},spawnQuant:{2:1}},clothArm2:{name:"Adept Robe",type:"armor",palette:"armorPalette",iconLoc:[32,128,32,32],buy:20,sell:10,stats:{iDefense:4,iVitality:2,iStrength:2},spawnQuant:{4:1}},clothArm3:{name:"Shining Robe",type:"armor",palette:"armorPalette",iconLoc:[64,128,32,32],buy:30,sell:15,stats:{iDefense:8,iVitality:3,iStrength:2,iDurability:1},spawnQuant:{6:1}},clothArm4:{name:"Ancient Robe",type:"armor",palette:"armorPalette",iconLoc:[128,128,32,32],buy:50,sell:25,stats:{iDefense:12,iVitality:4,iStrength:3,iDurability:1},spawnQuant:{8:1}},clothArm5:{name:"Brilliant Robe",type:"armor",palette:"armorPalette",iconLoc:[96,128,32,32],buy:80,sell:40,stats:{iDefense:16,iVitality:6,iStrength:3,iDurability:1},spawnQuant:{10:1}},leatherArm1:{name:"Cracked Leather Armor",type:"armor",palette:"armorPalette",iconLoc:[32,256,32,32],buy:10,sell:5,stats:{iDefense:4,iStrength:1,iAgility:1},spawnQuant:{2:1}},leatherArm2:{name:"Supple Leather Armor",type:"armor",palette:"armorPalette",iconLoc:[0,256,32,32],buy:20,sell:10,stats:{iDefense:8,iStrength:1,iAgility:2},spawnQuant:{4:1}},leatherArm3:{name:"Reinforced Leather Armor",type:"armor",palette:"armorPalette",iconLoc:[96,256,32,32],buy:30,sell:15,stats:{iDefense:16,iStrength:2,iAgility:2},spawnQuant:{6:1}},leatherArm4:{name:"Rune Leather Armor",type:"armor",palette:"armorPalette",iconLoc:[160,256,32,32],buy:50,sell:25,stats:{iDefense:20,iStrength:2,iAgility:4},spawnQuant:{8:1}},leatherArm5:{name:"Dark Leather Armor",type:"armor",palette:"armorPalette",iconLoc:[128,256,32,32],buy:80,sell:40,stats:{iDefense:20,iStrength:3,iAgility:6},spawnQuant:{10:1}},chainArm1:{name:"Rusted Chainmail Armor",type:"armor",palette:"armorPalette",iconLoc:[32,0,32,32],buy:10,sell:5,stats:{iDefense:8,iStrength:1},spawnQuant:{2:1}},chainArm2:{name:"Bronze Chainmail Armor",type:"armor",palette:"armorPalette",iconLoc:[0,0,32,32],buy:20,sell:10,stats:{iDefense:12,iStrength:2},spawnQuant:{4:1}},chainArm3:{name:"Reinforced Chainmail Armor",type:"armor",palette:"armorPalette",iconLoc:[234,0,32,32],buy:30,sell:15,stats:{iDefense:16,iStrength:3,iAgility:1},spawnQuant:{6:1}},chainArm4:{name:"Rune Chainmail Armor",type:"armor",palette:"armorPalette",iconLoc:[160,0,32,32],buy:50,sell:25,stats:{iDefense:24,iStrength:4,iAgility:1},spawnQuant:{8:1}},chainArm5:{name:"Brilliant Chainmail Armor",type:"armor",palette:"armorPalette",iconLoc:[192,0,32,32],buy:80,sell:40,stats:{iDefense:28,iStrength:5,iDurability:1,iAgility:1},spawnQuant:{10:1}},plateArm1:{name:"Rusted Plate Armor",type:"armor",palette:"armorPalette",iconLoc:[0,192,32,32],buy:10,sell:5,stats:{iDefense:12},spawnQuant:{2:1}},plateArm2:{name:"Bronze Plate Armor",type:"armor",palette:"armorPalette",iconLoc:[32,192,32,32],buy:20,sell:10,stats:{iDefense:16,iDurability:1},spawnQuant:{4:1}},plateArm3:{name:"Reinforced Plate Armor",type:"armor",palette:"armorPalette",iconLoc:[160,192,32,32],buy:30,sell:15,stats:{iDefense:24,iDurability:2},spawnQuant:{6:1}},plateArm4:{name:"Rune Plate Armor",type:"armor",palette:"armorPalette",iconLoc:[192,192,32,32],buy:50,sell:25,stats:{iDefense:32,iVitality:1,iDurability:2},spawnQuant:{8:1}},plateArm5:{name:"Brilliant Plate Armor",type:"armor",palette:"armorPalette",iconLoc:[224,192,32,32],buy:80,sell:40,stats:{iDefense:36,iVitality:2,iDurability:3},spawnQuant:{10:1}}},itemFeet={mageFt1:{name:"Tattered Cloth Boots",type:"foot",palette:"bootPalette",iconLoc:[96,0,32,32],buy:10,sell:5,stats:{iVitality:1,iStrength:1,iAgility:1},spawnQuant:{4:1}},mageFt2:{name:"Fine Cloth Boots",type:"foot",palette:"bootPalette",iconLoc:[128,0,32,32],buy:60,sell:30,stats:{iDefense:4,iVitality:2,iStrength:2,iAgility:2},spawnQuant:{9:1}},rogueFt1:{name:"Tattered Leather Boots",type:"foot",palette:"bootPalette",iconLoc:[0,0,32,32],buy:10,sell:5,stats:{iDefense:4,iAgility:2},spawnQuant:{4:1}},rogueFt2:{name:"Fine Leather Boots",type:"foot",palette:"bootPalette",iconLoc:[64,0,32,32],buy:60,sell:30,stats:{iDefense:8,iStrength:2,iAgility:3},spawnQuant:{9:1}},warriorFt1:{name:"Rusted Chain Boots",type:"foot",palette:"bootPalette",iconLoc:[192,0,32,32],buy:10,sell:5,stats:{iDefense:4,iStrength:2},spawnQuant:{4:1}},warriorFt2:{name:"Fine Chain Boots",type:"foot",palette:"bootPalette",iconLoc:[0,32,32,32],buy:60,sell:30,stats:{iDefense:12,iStrength:3,iAgility:1},spawnQuant:{9:1}},paladinFt1:{name:"Rusted Plate Boots",type:"foot",palette:"bootPalette",iconLoc:[32,0,32,32],buy:10,sell:5,stats:{iDefense:8,iDurability:1},spawnQuant:{4:1}},paladinFt2:{name:"Fine Plate Boots",type:"foot",palette:"bootPalette",iconLoc:[32,32,32,32],buy:60,sell:30,stats:{iDefense:16,iVitality:1,iDurability:2},spawnQuant:{9:1}}},itemGloves={mageGlv1:{name:"Cloth Gloves",type:"glove",palette:"glovePalette",iconLoc:[32,0,32,32],buy:30,sell:15,stats:{iVitality:2,iStrength:1,iAgility:1},spawnQuant:{3:1}},rogueGlv1:{name:"Leather Gloves",type:"glove",palette:"glovePalette",iconLoc:[0,0,32,32],buy:30,sell:15,stats:{iStrength:2,iAgility:2},spawnQuant:{3:1}},warriorGlv1:{name:"Battle Mitts",type:"glove",palette:"glovePalette",iconLoc:[64,0,32,32],buy:30,sell:15,stats:{iDefense:8,iStrength:2},spawnQuant:{3:1}},paladinGlv1:{name:"Plate Gloves",type:"glove",palette:"glovePalette",iconLoc:[96,0,32,32],buy:30,sell:15,stats:{iDefense:8,iDurabilty:2},spawnQuant:{3:1}}},itemHelmets={clothHead1:{name:"Snazzy Hat",type:"head",palette:"hatPalette",iconLoc:[0,64,32,32],buy:20,sell:10,stats:{iVitality:3,iStrength:1},spawnQuant:{2:1}},clothHead2:{name:"Wizard Hat",type:"head",palette:"hatPalette",iconLoc:[32,64,32,32],buy:60,sell:30,stats:{iDefense:4,iVitality:6,iStrength:4},spawnQuant:{5:1}},clothHead3:{name:"Enchanted Hat",type:"head",palette:"hatPalette",iconLoc:[64,64,32,32],buy:110,sell:55,stats:{iDefense:8,iVitality:12,iStrength:4,iAgility:2},spawnQuant:{8:1}},leatherHead1:{name:"Soft Leather Cap",type:"head",palette:"hatPalette",iconLoc:[0,32,32,32],buy:20,sell:10,stats:{iDefense:4,iStrength:1,iAgility:2},spawnQuant:{2:1}},leatherHead2:{name:"Hardened Leather Cap",type:"head",palette:"hatPalette",iconLoc:[32,32,32,32],buy:60,sell:30,stats:{iDefense:8,iStrength:2,iDurability:1,iAgility:6},spawnQuant:{5:1}},leatherHead3:{name:"Rune Leather Helmet",type:"head",palette:"hatPalette",iconLoc:[64,32,32,32],buy:110,sell:55,stats:{iDefense:16,iStrength:4,iDurability:2,iAgility:10},spawnQuant:{8:1}},mailHead1:{name:"Chainmail Cap",type:"head",palette:"hatPalette",iconLoc:[32,0,32,32],buy:20,sell:10,stats:{iDefense:4,iStrength:2,iDurability:1},spawnQuant:{2:1}},mailHead2:{name:"Platemail Cap",type:"head",palette:"hatPalette",iconLoc:[96,0,32,32],buy:60,sell:30,stats:{iDefense:12,iStrength:5,iDurability:2,iAgility:1},spawnQuant:{5:1}},mailHead3:{name:"Platemail Helmet",type:"head",palette:"hatPalette",iconLoc:[128,0,32,32],buy:110,sell:55,stats:{iDefense:24,iStrength:8,iDurability:4,iAgility:2},spawnQuant:{8:1}},crownHead1:{name:"Desciple's Crown",type:"head",palette:"hatPalette",iconLoc:[0,96,32,32],buy:20,sell:10,stats:{iVitality:2,iDurability:2},spawnQuant:{2:1}},crownHead2:{name:"Golden Crown",type:"head",palette:"hatPalette",iconLoc:[32,96,32,32],buy:60,sell:30,stats:{iDefense:8,iVitality:4,iDurability:4,iStrength:1},spawnQuant:{5:1}},crownHead3:{name:"King's Crown",type:"head",palette:"hatPalette",iconLoc:[64,96,32,32],buy:110,sell:55,stats:{iDefense:12,iVitality:10,iDurability:5,iStrength:2},spawnQuant:{8:1}}},itemRings={mageRng1:{name:"Damaged Ring of Striking",type:"ring",palette:"ringPalette",iconLoc:[0,0,32,32],buy:5,sell:2,stats:{iAttack:4},spawnQuant:{1:1}},mageRng2:{name:"Ring of Striking",type:"ring",palette:"ringPalette",iconLoc:[64,32,32,32],buy:20,sell:10,stats:{iAttack:8,iAgility:1},spawnQuant:{3:1}},mageRng3:{name:"Enchanted Ring of Striking",type:"ring",palette:"ringPalette",iconLoc:[64,64,32,32],buy:50,sell:25,stats:{iAttack:12,iVitality:1,iAgility:1},spawnQuant:{9:1}},rogueRng1:{name:"Damaged Ring of Stealth",type:"ring",palette:"ringPalette",iconLoc:[160,0,32,32],buy:5,sell:2,stats:{iAgility:1},spawnQuant:{1:1}},rogueRng2:{name:"Ring of Stealth",type:"ring",palette:"ringPalette",iconLoc:[0,32,32,32],buy:20,sell:10,stats:{iStrength:1,iAgility:2},spawnQuant:{3:1}},rogueRng3:{name:"Enchanted Ring of Stealth",type:"ring",palette:"ringPalette",iconLoc:[160,32,32,32],buy:50,sell:25,stats:{iVitalitY:1,iStrength:1,iAgility:3},spawnQuant:{9:1}},warriorRng1:{name:"Damaged Ring of Power",type:"ring",palette:"ringPalette",iconLoc:[192,0,32,32],buy:5,sell:2,stats:{iStrength:1},spawnQuant:{1:1}},warriorRng2:{name:"Ring of Power",type:"ring",palette:"ringPalette",iconLoc:[0,64,32,32],buy:20,sell:10,stats:{iDurability:1,iStrength:2},spawnQuant:{3:1}},warriorRng3:{name:"Enchanted Ring of Power",type:"ring",palette:"ringPalette",iconLoc:[96,96,32,32],buy:50,sell:25,stats:{iDurability:1,iStrength:3,iAgility:1},spawnQuant:{9:1}},paladinRng1:{name:"Damaged Ring of Life",type:"ring",palette:"ringPalette",iconLoc:[224,0,32,32],buy:5,sell:2,stats:{iVitality:1},spawnQuant:{1:1}},paladinRng2:{name:"Ring of Life",type:"ring",palette:"ringPalette",iconLoc:[192,32,32,32],buy:20,sell:10,stats:{iVitality:1,iDurability:1,iStrength:1},spawnQuant:{3:1}},paladinRng3:{name:"Enchanted Ring of Life",type:"ring",palette:"ringPalette",iconLoc:[32,64,32,32],buy:50,sell:25,stats:{iVitality:2,iDurability:2,iStrength:1},spawnQuant:{9:1}},specialRng1:{name:"Dark Ring",type:"ring",palette:"ringPalette",iconLoc:[128,96,32,32],buy:200,sell:100,stats:{iStrength:2,iAgility:2},spawnQuant:{}},specialRng2:{name:"Dark Glowing Ring",type:"ring",palette:"ringPalette",iconLoc:[32,128,32,32],buy:400,sell:200,stats:{iStrength:4,iAgility:3},spawnQuant:{}}},itemShields=_defineProperty({mageShd1:{name:"Arcane Shield",type:"shield",palette:"armorPalette",iconLoc:[32,96,32,32],buy:40,sell:20,stats:{iDefense:4,iVitality:2,iStrength:1,iDurability:1},spawnQuant:{6:1}},rogueShd1:{name:"Hardened Buckler",type:"shield",palette:"shieldPalette",iconLoc:[160,0,32,32],buy:40,sell:20,stats:{iDefense:8,iDurability:1,iAgility:3},spawnQuant:{6:1}},warriorShd1:{name:"Kite Shield of Wrath",type:"shield",palette:"shieldPalette",iconLoc:[64,0,32,32],buy:40,sell:20,stats:{iDefense:12,iStrength:3},spawnQuant:{6:1}}},"warriorShd1",{name:"Kite Shield of Rightousness",type:"shield",palette:"shieldPalette",iconLoc:[192,0,32,32],buy:40,sell:20,stats:{iDefense:12,iVitality:2,iDurability:1},
spawnQuant:{6:1}}),itemWeapons={wand1:{name:"Bent Stick",type:"weapon",palette:"wandPalette",iconLoc:[96,160,32,32],buy:10,sell:5,stats:{iAttack:8},spawnQuant:{1:1}},wand2:{name:"Summoning Fork",type:"weapon",palette:"wandPalette",iconLoc:[0,96,32,32],buy:20,sell:10,stats:{iAttack:20},spawnQuant:{2:1}},wand3:{name:"Scavenged Wand",type:"weapon",palette:"wandPalette",iconLoc:[32,0,32,32],buy:40,sell:20,stats:{iAttack:28,iVitality:1,iStrength:1},spawnQuant:{4:1}},wand4:{name:"Oak Rod",type:"weapon",palette:"wandPalette",iconLoc:[96,128,32,32],buy:60,sell:30,stats:{iAttack:52,iVitality:1,iStrength:2},spawnQuant:{5:1}},wand5:{name:"Rune Wand",type:"weapon",palette:"wandPalette",iconLoc:[224,0,32,32],buy:80,sell:40,stats:{iAttack:72,iVitality:2,iStrength:2},spawnQuant:{6:1}},wand6:{name:"Blazing Wand",type:"weapon",palette:"wandPalette",iconLoc:[32,128,32,32],buy:110,sell:55,stats:{iAttack:88,iVitality:2,iStrength:2,iAgility:2},spawnQuant:{9:1}},wand7:{name:"Divining Rod",type:"weapon",palette:"wandPalette",iconLoc:[0,192,32,32],buy:140,sell:70,stats:{iAttack:112,iVitality:4,iStrength:2,iAgility:2},spawnQuant:{10:1}},knife1:{name:"Arrow Head",type:"weapon",palette:"shortWepPalette",iconLoc:[96,32,32,32],buy:10,sell:5,stats:{iAttack:4,iAgility:1},spawnQuant:{1:1}},knife2:{name:"Bone Knife",type:"weapon",palette:"shortWepPalette",iconLoc:[64,32,32,32],buy:20,sell:10,stats:{iAttack:12,iAgility:2},spawnQuant:{2:1}},knife3:{name:"Fishing Knife",type:"weapon",palette:"shortWepPalette",iconLoc:[160,0,32,32],buy:40,sell:20,stats:{iAttack:20,iAgility:4},spawnQuant:{4:1}},knife4:{name:"Jagged Dagger",type:"weapon",palette:"shortWepPalette",iconLoc:[224,0,32,32],buy:60,sell:30,stats:{iAttack:32,iStrength:1,iAgility:5},spawnQuant:{5:1}},knife5:{name:"Rune Dagger",type:"weapon",palette:"shortWepPalette",iconLoc:[0,32,32,32],buy:80,sell:40,stats:{iAttack:48,iStrength:2,iAgility:6},spawnQuant:{7:1}},knife6:{name:"Coral Dagger",type:"weapon",palette:"shortWepPalette",iconLoc:[0,0,32,32],buy:110,sell:55,stats:{iAttack:68,iStrength:2,iAgility:7},spawnQuant:{9:1}},knife7:{name:"Divining Dagger",type:"weapon",palette:"shortWepPalette",iconLoc:[96,0,32,32],buy:140,sell:70,stats:{iAttack:92,iStrength:3,iAgility:9},spawnQuant:{10:1}},sword1:{name:"Rough Club",type:"weapon",palette:"shortWepPalette",iconLoc:[32,64,32,32],buy:10,sell:5,stats:{iAttack:4,iStrength:1},spawnQuant:{1:1}},sword2:{name:"Practice Sword",type:"weapon",palette:"medWepPalette",iconLoc:[128,0,32,32],buy:20,sell:10,stats:{iAttack:12,iStrength:2},spawnQuant:{2:1}},sword3:{name:"Short Sword",type:"weapon",palette:"medWepPalette",iconLoc:[160,0,32,32],buy:40,sell:20,stats:{iAttack:20,iStrength:4},spawnQuant:{4:1}},sword4:{name:"Bronze Sword",type:"weapon",palette:"medWepPalette",iconLoc:[64,0,32,32],buy:60,sell:30,stats:{iAttack:32,iStrength:5,iAgility:1},spawnQuant:{5:1}},sword5:{name:"Rune Sword",type:"weapon",palette:"medWepPalette",iconLoc:[96,0,32,32],buy:80,sell:40,stats:{iAttack:44,iStrength:7,iAgility:2},spawnQuant:{7:1}},sword6:{name:"Coral Sword",type:"weapon",palette:"medWepPalette",iconLoc:[0,0,32,32],buy:110,sell:55,stats:{iAttack:60,iStrength:9,iAgility:2},spawnQuant:{9:1}},sword7:{name:"Dark Sword",type:"weapon",palette:"medWepPalette",iconLoc:[32,0,32,32],buy:140,sell:70,stats:{iAttack:80,iStrength:11,iAgility:3},spawnQuant:{10:1}},pole1:{name:"Long Pole",type:"weapon",palette:"longWepPalette",iconLoc:[64,128,32,32],buy:10,sell:5,stats:{iAttack:4,iDurability:1},spawnQuant:{1:1}},pole2:{name:"Big Spade",type:"weapon",palette:"longWepPalette",iconLoc:[128,128,32,32],buy:20,sell:10,stats:{iAttack:8,iVitality:1,iDurability:1},spawnQuant:{2:1}},pole3:{name:"Trident",type:"weapon",palette:"longWepPalette",iconLoc:[192,0,32,32],buy:40,sell:20,stats:{iAttack:16,iVitality:2,iDurability:1,iStrength:1},spawnQuant:{4:1}},pole4:{name:"Narrow Spear",type:"weapon",palette:"longWepPalette",iconLoc:[160,0,32,32],buy:60,sell:30,stats:{iAttack:24,iVitality:3,iDurability:2,iStrength:2},spawnQuant:{5:1}},pole5:{name:"Rune Voulge",type:"weapon",palette:"longWepPalette",iconLoc:[128,64,32,32],buy:80,sell:40,stats:{iAttack:36,iVitality:4,iDurability:2,iStrength:4},spawnQuant:{7:1}},pole6:{name:"Coral Bardiche",type:"weapon",palette:"longWepPalette",iconLoc:[32,128,32,32],buy:110,sell:55,stats:{iAttack:48,iVitality:4,iDurability:4,iStrength:5},spawnQuant:{9:1}},pole7:{name:"Royal Poleaxe",type:"weapon",palette:"longWepPalette",iconLoc:[128,0,32,32],buy:140,sell:70,stats:{iAttack:72,iVitality:5,iDurability:5,iStrength:5},spawnQuant:{10:1}}},interactivePortals={inactivePortal:{name:"Inactive Portal",type:"door",palette:["door0Palette","door1Palette"],iconLoc:[64,160,32,32]},activePortal:{name:"Active Portal",type:"door",palette:["door0Palette","door1Palette"],iconLoc:[96,160,32,32]}},_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),ActivityLog=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initActivityLog=a.initActivityLog.bind(a),a.recycleLog=a.recycleLog.bind(a),a.resetLog=a.resetLog.bind(a),a.logAdd=a.logAdd.bind(a),a.logLevelUp=a.logLevelUp.bind(a),a.logItem=a.logItem.bind(a),a.logStatPoint=a.logStatPoint.bind(a),a.logAttacks=a.logAttacks.bind(a),a.logEnemyDead=a.logEnemyDead.bind(a),a.logLen=300,a.renderLen=30,a.logArrayPadding=10,a.enemyDeadCount=0,a.state={log:[],index:-1},a}return _inherits(t,e),_createClass(t,[{key:"initActivityLog",value:function(){var e=this.state.log;e.length=this.logLen,this.setState({log:e})}},{key:"resetLog",value:function(){this.setState({index:-1})}},{key:"recycleLog",value:function(e,t){for(var a=this.renderLen,n=0;n<a;n++)e[n]=e[t-a+n+1];t=a-1,this.setState({log:e,index:t})}},{key:"logAdd",value:function(e){var t=this.state,a=t.index,n=t.log;e.forEach(function(e){a++,n[a]=e}),a>this.logLen-this.logArrayPadding?this.recycleLog(n,a):this.setState({log:n,index:a})}},{key:"logLevelUp",value:function(){this.logAdd([{type:"log-level",message:"Level Up!"}])}},{key:"logItem",value:function(e){var t=e.interactItem,a=t.type,n=a.charAt(0).toUpperCase()+a.slice(1),r=[],o="",i=void 0;if("buy"===a.slice(0,3)?"buySuccess"===a?r.push({type:"log-item",message:n.slice(0,3)+" "+t.item.name}):"buyFail"===a&&r.push({type:"log-item",message:"Not enough to buy."}):r.push({type:"log-item",message:n+" "+t.item.name}),"use"===a)for(o in t.item.stats)i="curHealth"===o?o.slice(3):o.slice(1),r.push({type:"log-stat",message:"Increased "+i});this.logAdd(r)}},{key:"logStatPoint",value:function(e){var t=e.increasedStat;this.logAdd([{type:"log-stat",message:t.type+" "+t.stat+"."}])}},{key:"logAttacks",value:function(e){var t=e.enemyDead,a=e.exchangeAttacks.attacks,n="",r=[];a.forEach(function(e){n="hero"===e.from?"You attack "+e.to+".":e.from+" attacks you.",r.push({type:"log-attack",message:n}),n=e.type.charAt(0).toUpperCase()+e.type.slice(1)+": "+e.damage+" damage.",r.push({type:"log-attack",message:n})}),t.count!==this.enemyDeadCount?this.logEnemyDead(t,r):this.logAdd(r)}},{key:"logEnemyDead",value:function(e,t){var a=e.experience,n=e.gold,r=e.source,o=e.count,i=r.name;t.push({type:"log-attack",message:i+" died."}),t.push({type:"log-stat",message:"Gained "+a+" experience."}),t.push({type:"log-stat",message:"Looted "+n+" gold."}),r.boss&&t.push({type:"log-stat",message:"A portal has opened somewhere...."}),this.enemyDeadCount=o,this.logAdd(t)}},{key:"componentWillMount",value:function(){this.initActivityLog()}},{key:"componentWillReceiveProps",value:function(e){this.props.levelUpCount!==e.levelUpCount&&this.logLevelUp(),this.props.interactItem.count!==e.interactItem.count&&this.logItem(e),this.props.increasedStat.count!==e.increasedStat.count&&this.logStatPoint(e),this.props.exchangeAttacks.count!==e.exchangeAttacks.count&&this.logAttacks(e),this.props.gameLevel!==e.gameLevel&&this.resetLog()}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.levelUpCount!==e.levelUpCount||this.props.interactItem.count!==e.interactItem.count||this.props.increasedStat.count!==e.increasedStat.count||this.props.exchangeAttacks.count!==e.exchangeAttacks.count||this.props.gameLevel!==e.gameLevel}},{key:"render",value:function(){var e=this.state,t=e.log,a=e.index,n=a<this.renderLen-1?a:this.renderLen-1,r=[],o=0;for(o=n;o>-1;o--)r.push(React.createElement(ActivityLogRow,{key:o+t[a-o].message,type:t[a-o].type,message:t[a-o].message}));return React.createElement("div",{className:"activity-log"},React.createElement("div",{className:"log-content"},r))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),ActivityLogRow=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("p",{className:"log "+this.props.type},this.props.message)}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),ConsumableItems=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.handleInteractItem=a.handleInteractItem.bind(a),a.updateConsumeCanvas=a.updateConsumeCanvas.bind(a),a.state={cItems:["potion","hiPotion","xPotion","tomeOfVitality","tomeOfDurability","tomeOfStrength","tomeOfAgility","tomeOfWisdom"]},a}return _inherits(t,e),_createClass(t,[{key:"handleInteractItem",value:function(e){var t=e.quickConsume.num,a=e.inventory,n=Object.assign({},e.interactItem),r=consumableAbbrevMap,o="",i=null,s=null;for(s in r)t==r[s].num&&(o=r[s].name);(i=a[o])&&i.count>0&&(n.count+=1,n.type="use",n.item=i,e.updateGameClassState({interactItem:n}))}},{key:"updateConsumeCanvas",value:function(e){var t=e.interactItem,a=e.inventory,n=t.item,r=t.type,o=consumableAbbrevMap,i=!1,s=null,l=null,c=null,u=[];if((1===a[n.name].count&&["pickup","buySuccess"].includes(r)||0===a[n.name].count&&["use","sell"].includes(r))&&(i=!0),i){for(s in o)n.name===o[s].name&&(l=getById(s+"-canvas").getContext("2d"));c=e.itemPalettes[n.palette],u=n.iconLoc,["use","sell"].includes(r)?l.clearRect(0,0,u[2],u[3]):l.drawImage(c,u[0],u[1],u[2],u[3],0,0,u[2],u[3])}}},{key:"componentWillReceiveProps",value:function(e){this.props.quickConsume.count!==e.quickConsume.count&&e.quickConsume.count&&this.handleInteractItem(e),this.props.interactItem.count!==e.interactItem.count&&e.interactItem.count&&["pickup","use","buySuccess","sell"].includes(e.interactItem.type)&&"consumable"===e.interactItem.item.type&&this.updateConsumeCanvas(e)}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.quickConsume.count!==e.quickConsume.count||this.props.interactItem.count!==e.interactItem.count}},{key:"render",value:function(){var e=consumableAbbrevMap,t=this.state.cItems,a=this.props.inventory,n=this.props.tileSize,r=[],o=0;return r=t.map(function(t){return o=0,a[e[t].name]&&(o=a[e[t].name].count),React.createElement("div",{className:"consumable-col",key:"consumable-col"+e[t].num},React.createElement("p",{className:"consumable-col-num",key:"consumable-col-num"+e[t].num},e[t].num),React.createElement("canvas",{id:t+"-canvas",className:"consumable-canvas",key:t+"-canvas",width:n,height:n}),React.createElement("p",{className:"consumable-col-abbrev",key:"consumable-col-abbrev"+e[t].num},e[t].abbrev),React.createElement("p",{className:"consumable-col-count",key:"consumable-col-count"+e[t].num},"x"+o))}),React.createElement("div",{className:"consumable-items"},r)}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),CurrentObjective=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.resetBossDead=a.resetBossDead.bind(a),a.handleEnemyDead=a.handleEnemyDead.bind(a),a.enemyDeadCount=0,a.objectives={false:"Find and slay boss",true:"Travel through portal"},a.state={bossDead:!1},a}return _inherits(t,e),_createClass(t,[{key:"resetBossDead",value:function(){this.setState({bossDead:!1})}},{key:"handleEnemyDead",value:function(e){var t=e.enemyDead;this.enemyDeadCount=t.count,t.source.boss&&this.setState({bossDead:!0})}},{key:"componentWillReceiveProps",value:function(e){this.enemyDeadCount!==e.enemyDead.count&&this.handleEnemyDead(e),this.props.gameLevel!==e.gameLevel&&this.resetBossDead()}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.bossDead!==t.bossDead}},{key:"render",value:function(){return React.createElement("div",{className:"current-objective"},React.createElement("p",null,"Current Objective"),React.createElement("p",null,this.objectives[this.state.bossDead]))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),Enemy=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initEnemy=a.initEnemy.bind(a),a.chooseMove=a.chooseMove.bind(a),a.attemptMove=a.attemptMove.bind(a),a.completeMove=a.completeMove.bind(a),a.stay=a.stay.bind(a),a.attack=a.attack.bind(a),a.die=a.die.bind(a),a.takeDamage=a.takeDamage.bind(a),a.startTurn=a.startTurn.bind(a),a.updateEnemyDisplay=a.updateEnemyDisplay.bind(a),a.state={level:0,maxHealth:0,curHealth:0,baseStats:{},position:[],icon:null},a}return _inherits(t,e),_createClass(t,[{key:"initEnemy",value:function(){var e=this.props,t=e.source,a=e.tileSize,n=e.enemyPalettes,r=randInt(t.levelRange[0],t.levelRange[1]),o=t.baseStats,i=t.onLevelUp,s=this.props.spawnCoord,l=statConversion,c=document.createElement("canvas"),u={},p=0,m=0,h=0,y=null,d=null;c.width=a,c.height=a,d=c.getContext("2d"),d.imageSmoothingEnabled=!1,d.drawImage(n[t.palette[0]],t.iconLoc[0],t.iconLoc[1],a,a,0,0,a,a);for(y in o)h=o[y],i[y]&&(h+=r*i[y]),u[y]=h;p=u.bHealth+l.vitToHp*u.bVitality+l.durToHp*u.bDurability,m=p,this.updateEnemyDisplay(s,m,p,r,c),this.setState({level:r,maxHealth:p,curHealth:m,baseStats:u,position:s,icon:c})}},{key:"updateEnemyDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.position,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state.curHealth,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.state.maxHealth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.state.level,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.state.icon,o=this.props,i=o.source,s=o.spawnIndex,l={position:e,curHealth:t,maxHealth:a,level:n,icon:r,source:i,name:i.name,type:i.type};this.props.updateEnemyDisplayArr(l,s)}},{key:"chooseMove",value:function(e,t,a,n){var r=this.props.floor,o=[],i=[],s=[],l={},c={},u={},p={},m={},h=0,y=0,d=0,b=0,g=0,f=0,v=0,w=0;for(y=1.001*(Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])),b=y,u[""+e]={costToSpace:h,costToGoal:y,fCost:b,coord:e,parent:{}},l[""+e]=u[""+e],o.push(l[""+e]);o[0].coord[0]!==t[0]||o[0].coord[1]!==t[1];)if(m=o.shift(),v=m.coord[0],w=m.coord[1],f++,delete l[""+m.coord],[[v-1,w],[v+1,w],[v,w+1],[v,w-1]].forEach(function(e){d=n[e[0]][e[1]]>r&&!a[e[0]][e[1]]?1:1e3,h=m.costToSpace+d,l[""+e]&&h<l[""+e].costToSpace&&(g=o.findIndex(function(t){return t[0]===e[0]&&t[1]===e[1]}),o.splice(g,1),delete l[""+e]),c[""+e]&&h<c[""+e].costToSpace&&delete c[""+e],l[""+e]||c[""+e]||(y=1.001*(Math.abs(e[0]-t[0])+Math.abs(e[1]-t[1])),b=h+y,p=u[""+m.coord],u[""+e]={costToSpace:h,costToGoal:y,fCost:b,parent:p,coord:e},l[""+e]=u[""+e],g=o.findIndex(function(e){return b<e.fCost}),g>-1?o.splice(g,0,l[""+e]):o.push(l[""+e]))}),f>100){console.log("MOVE LIMIT EXCEEDED");break}for(m=o[0],i=m.coord;i.length&&(i[0]!==e[0]||i[1]!==e[1]);)s.unshift(i),m=m.parent,i=m.coord;return s[0]}},{key:"attemptMove",value:function(e){var t=e.bgArr,a=e.roundEnemyArr,n=e.playerArr,r=e.source,o=this.state.baseStats,i=this.state.position,s=[],l={};s=this.chooseMove(i,n,a,t),o.curHealth=this.state.curHealth,l={stats:o,source:r,fromCoord:i,toCoord:s,type:"move",status:!1},this.props.updateEnemyTurn(l,e.spawnIndex),this.props.incrementPollCount()}},{key:"completeMove",value:function(e){this.updateEnemyDisplay(e),this.setState({position:[].concat(_toConsumableArray(e))})}},{key:"stay",value:function(e){var t=this.state.baseStats,a=this.state.position,n={};t.curHealth=this.state.curHealth,n={stats:t,type:"stay",source:e.source,fromCoord:a,toCoord:a,status:!1},this.props.updateEnemyTurn(n,e.spawnIndex),this.props.incrementPollCount()}},{key:"attack",value:function(e){var t=e.playerArr,a=e.source,n=this.state.baseStats,r=this.state.position,o={};n.curHealth=this.state.curHealth,o={stats:n,source:a,fromCoord:r,type:"attack",toCoord:t,status:!1},this.props.updateEnemyTurn(o,e.spawnIndex),this.props.incrementPollCount()}},{key:"die",value:function(){for(var e=this.state,t=e.position,a=e.level,n=this.props,r=n.spawnIndex,o=n.source,i=Object.assign(this.props.enemyDead),s=statConversion,l=0,c=0,u=0;u<a;u++)l+=randInt(s.lvlToExpRange[0],s.lvlToExpRange[1]),c+=randInt(s.lvlToGoldRange[0],s.lvlToGoldRange[1]);this.props.source.boss&&(l*=s.bossMultiplier,c*=s.bossMultiplier),i.count++,i.spawnIndex=r,i.coord=t,i.source=o,i.level=a,i.experience=~~l,i.gold=~~c,this.props.updateGameClassState({enemyDead:i})}},{key:"takeDamage",value:function(e){var t=this.state.curHealth,a=0;e.forEach(function(e){"hero"===e.from&&(a=e.damage)}),t=t-a>0?t-a:0,t||this.die(),this.updateEnemyDisplay(this.state.position,t),this.setState({curHealth:t})}},{key:"startTurn",value:function(e){var t=this.state,a=t.position,n=t.curHealth,r=e.playerArr,o=e.source.aggression;n<1||linearDistance(a,r)>o?this.stay(e):r[0]===a[0]&&1===Math.pow(r[1]-a[1],2)||r[1]===a[1]&&1===Math.pow(r[0]-a[0],2)?this.attack(e):o+94>randInt(1,100)?this.attemptMove(e):this.stay(e)}},{key:"componentWillMount",value:function(){this.initEnemy()}},{key:"componentWillReceiveProps",value:function(e){0===e.pollCount&&this.props.moveCount!==e.moveCount&&this.startTurn(e),this.props.exchangeAttacks.count!==e.exchangeAttacks.count&&e.exchangeAttacks.spawnIndex===e.spawnIndex&&this.takeDamage(e.exchangeAttacks.attacks),this.props.roundCount!==e.roundCount&&"move"===e.enemyTurn[this.props.spawnIndex].type&&e.enemyTurn[this.props.spawnIndex].status&&this.completeMove(e.enemyTurn[e.spawnIndex].toCoord)}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"render",value:function(){return React.createElement("div",null)}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),EnemyManager=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.getManagerImages=a.getManagerImages.bind(a),a.setPalettes=a.setPalettes.bind(a),a.resetMerchantInventories=a.resetMerchantInventories.bind(a),a.setLevelEnemies=a.setLevelEnemies.bind(a),a.runEnemyRound=a.runEnemyRound.bind(a),a.handleEnemyDead=a.handleEnemyDead.bind(a),a.updateEnemyManager=a.updateEnemyManager.bind(a),a.incrementPollCount=a.incrementPollCount.bind(a),a.updateEnemyTurn=a.updateEnemyTurn.bind(a),a.updateEnemyDisplayArr=a.updateEnemyDisplayArr.bind(a),a.setEnemyDisplay=a.setEnemyDisplay.bind(a),a.drawEnemyIcon=a.drawEnemyIcon.bind(a),a.pollCount=-1,a.enemyDeadCount=0,a.enemyTurn=[],a.enemyDisplayArr=[],a.enemyDisplay={},a.bossDead=!1,a.srcTileSize=16,a.renderSmoothing=!1,a.imgArrowCropDimensions={srcX:2,srcY:41,firstRowTiles:5,tileCount:8,arrowOrder:[2,6,4,0,1,7,3,5]},a.state={roundCount:0,levelProcessed:0,enemiesRemaining:0,currentIndex:0,displayUpdateCount:0,levelEnemies:[],roundEnemyArr:[],nextKey:0,interfaceImage:null,arrowCanvases:[]},a}return _inherits(t,e),_createClass(t,[{key:"getManagerImages",value:function(){var e=this,t=new Image,a=function(){e.setState({interfaceImage:t}),e.setPalettes(t)};t.src="img/gui/ToenTileSet.png",t.addEventListener("load",a)}},{key:"resetMerchantInventories",value:function(){for(var e in merchantInventories)enemyHumanoid[e].inventory=Object.assign({},merchantInventories[e])}},{key:"setPalettes",value:function(e){var t=this.props.tileSize,a=this.srcTileSize,n=this.renderSmoothing,r=this.state.arrowCanvases,o=this.imgArrowCropDimensions,i=o.srcX,s=o.srcY,l=o.firstRowTiles,c=o.tileCount,u=o.arrowOrder,p=null,m=null,h=0;for(r.length<c&&(r.length=c);h<c;h++)p=document.createElement("canvas"),p.width=t,p.height=t,m=p.getContext("2d"),m.imageSmoothingEnabled=n,h===l&&(s++,i=0),m.drawImage(e,a*i,a*s,a,a,0,0,t,t),r[u[h]]=p,i++;this.setState({arrowCanvases:r})}},{key:"incrementPollCount",value:function(){++this.pollCount===this.state.levelEnemies.length&&this.runEnemyRound(this.props)}},{key:"updateEnemyTurn",value:function(e,t){this.enemyTurn[t]=e}},{key:"updateEnemyDisplayArr",value:function(e,t){var a=!1;e.curHealth!==e.maxHealth&&this.enemyDisplayArr[t]&&this.enemyDisplayArr[t].curHealth!==e.curHealth&&(a=!0),this.enemyDisplayArr[t]=e,a&&this.setEnemyDisplay()}},{key:"setLevelEnemies",value:function(){var e=this.props,t=e.gameLevel,a=e.itemLevelProcessed,n=e.bgArr,r=n.length,o=[enemyAvian,enemyDemon,enemyElemental,enemyHumanoid,enemyReptile,enemyUndead],i=[].concat(_toConsumableArray(this.props.floorCoords)),s=initZeroArray(r),l=this.state.nextKey,c=[],u=[],p=[0,0],m=0,h={},y=null,d=0,b=0,g=0;o.forEach(function(e){for(y in e)for(h=e[y],b=h.spawnQuant[""+t]?h.spawnQuant[""+t]:0,d+=b,g=0;g<b;){if("merchant"===h.type){for(;45!==n[p[0]][p[1]]||45!==n[p[0]-1][p[1]]||45!==n[p[0]][p[1]+1]||45!==n[p[0]+1][p[1]]||45!==n[p[0]][p[1]-1];)m=randInt(0,i.length-1),p=i[m];u=i.splice(m,1)[0],console.log("Merchant at: ",u)}else u=i.splice(randInt(0,i.length-1),1)[0];s[u[0]][u[1]]=h,l++,c.push({source:h,spawnCoord:u,key:l}),g++,h.boss&&console.log("Boss at: ",u)}}),this.enemyTurn.length=d,this.enemyDisplayArr.length=d,this.bossDead=!1,this.props.updateGameClassState({floorCoords:i,enemyArr:s}),this.setState({levelEnemies:c,enemiesRemaining:d,nextKey:l,levelProcessed:a,roundEnemyArr:s})}},{key:"runEnemyRound",value:function(e){for(var t=e.enemyAttack,a=[].concat(_toConsumableArray(this.enemyTurn)),n=[].concat(_toConsumableArray(this.state.roundEnemyArr)),r=this.state,o=r.roundCount,i=r.currentIndex,s=r.levelEnemies,l=t.count,c="",u={},p={},m=[],h=[],y=!1,d=0;i<this.pollCount;){var b=a[i];c=b.type,u=b.source,p=b.stats,h=b.fromCoord,m=b.toCoord,y=b.status,"stay"===c?a[i].status=!0:"move"===c?(y=0===n[m[0]][m[1]],y&&(n[h[0]][h[1]]=0,n[m[0]][m[1]]=u),a[i].status=y):"attack"===c&&(l++,d=i,a[i].status=!0,e.updateGameClassState({enemyAttack:{count:l,roundCount:o,spawnIndex:d,stats:p,source:u}})),i++}i===s.length&&(i=0,this.pollCount=0,o++,e.updateGameClassState({enemyArr:n})),this.enemyTurn=[].concat(a),this.setState({roundEnemyArr:n,currentIndex:i,roundCount:o})}},{key:"handleEnemyDead",value:function(e){var t=e.enemyDead,a=t.coord,n=e.enemyArr,r=this.state.roundEnemyArr;r[a[0]][a[1]]=0,n=[].concat(_toConsumableArray(r)),this.enemyDeadCount=t.count,t.source.boss&&(this.bossDead=!0),e.updateGameClassState({enemyArr:n}),this.setState({roundEnemyArr:r})}},{key:"updateEnemyManager",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState(e)}},{key:"drawEnemyIcon",value:function(e){var t=this.props.tileSize,a=getById("enemy-icon").getContext("2d");a.clearRect(0,0,t,t),e&&a.drawImage(e,0,0)}},{key:"setEnemyDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.playerArr,a=e.portalObjective,n=this.state.arrowCanvases,r=a.coord,o=a.discovered,i=this.enemyDisplayArr,s=Math.PI,l=s/8,c=5,u={},p={},m=[],h=null,y=!1,d=0,b=0,g=0,f=0,v=0,w=0,A=0,C=0;i.forEach(function(e,a){e&&e.curHealth&&(y=!1,m=i[a].position,d=Math.abs(t[0]-m[0])+Math.abs(t[1]-m[1]),c=m[0]===t[0]||m[1]===t[1]?4:5,d<=c&&(v=a,g=e.maxHealth,f=e.curHealth,b=g-f,p=e.source,!u.maxHealth||d<u.distance?y=!0:d===u.distance&&(b>u.healthLost?y=!0:b===u.healthLost&&g>u.maxHealth&&(y=!0)),y&&(u={position:m,distance:d,index:v,maxHealth:g,curHealth:f,healthLost:b,source:p})))}),u.index&&i[u.index].curHealth===this.enemyDisplay.curHealth&&i[u.index].name===this.enemyDisplay.name&&i[u.index].level===this.enemyDisplay.level||(this.enemyDisplay=u.curHealth?i[u.index]:{},h=!!this.enemyDisplay.icon&&this.enemyDisplay.icon,this.drawEnemyIcon(h),this.setState({displayUpdateCount:this.state.displayUpdateCount+1})),!Object.keys(this.enemyDisplay).length&&this.bossDead&&o&&(w=t[0]-r[0],A=t[1]-r[1],C=A>=0&&w>=0?Math.atan(A/w):A>=0&&w<0?s/2+Math.atan(w/A*-1):A<0&&w<0?s+Math.atan(A/w):3*s/2+Math.atan(w/A*-1),v=~~((C+l)/(s/4))%n.length,this.drawEnemyIcon(n[v]))}},{key:"componentDidMount",value:function(){this.getManagerImages(),this.resetMerchantInventories()}},{key:"componentWillReceiveProps",value:function(e){-1===this.pollCount&&this.state.levelEnemies.length&&this.props.moveCount!==e.moveCount&&(this.pollCount=0),this.enemyDeadCount!==e.enemyDead.count&&this.handleEnemyDead(e),this.props.moveCount!==e.moveCount&&this.setEnemyDisplay(e)}},{key:"componentDidUpdate",value:function(e,t){this.state.levelProcessed!==this.props.itemLevelProcessed&&Object.keys(this.props.enemyPalettes).length&&this.setLevelEnemies()}},{key:"render",value:function(){var e=this,t=this.state.levelEnemies,a=this.props.portalObjective,n=this.props.tileSize,r=this.enemyDisplay,o=[],i=[],s={},l=0,c=null,u=null,p=null,m=null,h=null,y="",d="none",b="",g=0,f="",v="none";return t.forEach(function(t){s=t.source,i=t.spawnCoord,l=t.key,o.push(React.createElement(Enemy,{key:s.name+l,source:s,spawnIndex:o.length,spawnCoord:i,pollCount:e.pollCount,roundCount:e.state.roundCount,enemyTurn:e.enemyTurn,roundEnemyArr:e.state.roundEnemyArr,enemyDisplayArr:e.enemyDisplayArr,tileSize:e.props.tileSize,floor:e.props.floor,moveCount:e.props.moveCount,playerArr:e.props.playerArr,bgArr:e.props.bgArr,enemyArr:e.props.enemyArr,exchangeAttacks:e.props.exchangeAttacks,enemyDead:e.props.enemyDead,enemyPalettes:e.props.enemyPalettes,incrementPollCount:e.incrementPollCount,updateEnemyTurn:e.updateEnemyTurn,updateEnemyDisplayArr:e.updateEnemyDisplayArr,updateEnemyManager:e.updateEnemyManager,updateGameClassState:e.props.updateGameClassState}))}),r.name?(c="merchant"===r.type?"Merchant":"Enemy",u=r.name,p=r.type[0].toUpperCase()+r.type.slice(1),m=r.level,h=r.curHealth+"/"+r.maxHealth,y="6em",b="10em",d="1px solid rgb(0, 0, 0)",g=~~(r.curHealth/r.maxHealth*100),f=g+"%",v=g>70?"rgba(0,255,0,.8)":g>30?"rgba(255,255,0,.8)":"rgba(255,0,0,.7)"):this.bossDead&&a.discovered&&(c="To Portal"),React.createElement("div",{className:r.name&&r.source.boss?"enemy-manager enemy-manager-boss":"enemy-manager"},React.createElement("p",{className:"enemy-manager-title"},c),React.createElement("canvas",{id:"enemy-icon",className:"enemy-icon",width:n,height:n}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,React.createElement("span",null,u?"Name: ":null),React.createElement("span",null,u)),React.createElement("p",null,React.createElement("span",null,p?"Type: ":null),React.createElement("span",null,p)),React.createElement("p",null,React.createElement("span",null,m?"Level: ":null),React.createElement("span",null,m)),React.createElement("p",{className:"enemy-health-row"},React.createElement("span",{className:"enemy-health-row-title",style:{width:y}},React.createElement("span",{className:"health-text"},h?"Health: ":null)),React.createElement("span",{id:"enemy-health",className:"enemy-health",style:{width:b,border:d}},React.createElement("span",{className:"enemy-health-number"},h),React.createElement("span",{id:"enemy-health-gauge",className:"enemy-health-gauge",style:{width:f,background:v}})))),o)}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),GameLevel=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.levelNames={1:"The Threshold",2:"Forboding Cave",3:"Cave of Hopelessness",4:"Cave of Despair",5:"Abyss Cave",6:"Dungeon Entry",7:"Demon Palisades",8:"Feeding Dungeon",9:"Death's Doorstep",10:"The Abyss"},a}return _inherits(t,e),_createClass(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.gameLevel!==e.gameLevel}},{key:"render",value:function(){var e=this.props.gameLevel,t=this.levelNames[e];return React.createElement("div",{className:"level"},React.createElement("p",{className:"level-header"},"Level "+e),React.createElement("p",{className:"level-name"},t))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),GameSounds=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.loadEffects=a.loadEffects.bind(a),a.playBackgroundSong=a.playBackgroundSong.bind(a),a.toggleMute=a.toggleMute.bind(a),a.playEffect=a.playEffect.bind(a),a.handleInteractItem=a.handleInteractItem.bind(a),a.handleOverlayToggle=a.handleOverlayToggle.bind(a),a.handleAttackRound=a.handleAttackRound.bind(a),a.handleEnemyDead=a.handleEnemyDead.bind(a),a.soundKeys={path:"sounds/",effectKeys:{activatePortal:"activate-portal",attackMiss:"attack-miss",attackRound:"attack-round",buySellItem:"buy-sell-item",changeEquipment:"change-eqipment",chooseNewGame:"choose-new-game",closeOverlay:"close-overlay",criticalHit:"critical-hit",enemyDead:"enemy-dead",heroDead:"hero-dead",heroSelection:"hero-selection",levelUp:"level-up",notEnoughGold:"not-enough-gold",openOverlay:"open-overlay",pickupGold:"pickup-gold",pickupItem:"pickup-item",teleportThroughPortal:"teleport-through-portal",usePotion:"use-potion",useStatPoint:"use-stat-point",useTome:"use-tome"},effectPre:"effect-",effectPost:".wav",effectType:"audio/wav",musicKeys:{intro:"00-intro",level:"-level",gameOver:"11-game-over",gameWin:"12-game-win"},musicPre:"music-",musicPost:".mp3",musicType:"audio/mp3"},a.musicOverlays={"hero-selection-overlay":{overlay:"hero-selection-overlay",pointerKey:"intro"},"game-over-overlay":{overlay:"game-over-overlay",pointerKey:"gameOver"},"game-win-overlay":{overlay:"game-win-overlay",pointerKey:"gameWin"}},a.effectOverlays={"inv-overlay":{overlay:"inv-overlay"},"help-overlay":{overlay:"help-overlay"},"merchant-overlay":{overlay:"merchant-overlay"}},a.enemyDeadCount=0,a.state={song:null,songPromise:null,effects:{}},a}return _inherits(t,e),_createClass(t,[{key:"loadEffects",value:function(){
var e=this.soundKeys,t=e.path,a=e.effectKeys,n=e.effectPre,r=e.effectPost,o=e.effectType,i={},s="";for(s in a)i[s]=new Audio,i[s].src=t+n+a[s]+r,i[s].type=o;this.setState({effects:i})}},{key:"playBackgroundSong",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.props,n=this.soundKeys,r=n.path,o=n.musicKeys,i=n.musicPre,s=n.musicPost,l=n.musicType,c=this.musicOverlays,u=this.state.song,p=this.state.songPromise,m=null,h=null,y="",d="";p?p.then(function(){return u.pause()}):u&&(console.log("Stopped Song"),u.pause());var b=function(){a.gameMuted&&(m.muted=!0)};for(d in c)c[d].overlay===t&&(y=o[c[d].pointerKey]);y||(y=("0"+e).slice(-2)+o.level),m=new Audio,m.src=r+i+y+s,m.type=l,m.loop=!0,m.preload=!0,h=m.play(),m.addEventListener("loadeddata",b),this.setState({song:m,songPromise:h})}},{key:"playEffect",value:function(e){this.props.gameMuted||this.state.effects[e].play().catch(function(e){})}},{key:"toggleMute",value:function(e){this.state.song.muted=e}},{key:"handleInteractItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.interactItem,a=t.type,n=t.item,r="";"buyFail"===a?r="notEnoughGold":["buySuccess","sell"].includes(a)?r="buySellItem":["equip","unequip"].includes(a)?r="changeEquipment":"pickup"===a?r="gold"===n.type?"pickupGold":"pickupItem":"use"===a&&(r="Potion"===n.name.slice(-6)?"usePotion":"useTome"),"buy"!==a&&this.playEffect(r)}},{key:"handleAttackRound",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.exchangeAttacks.attacks,a="";a=t.some(function(e){return"critical hit"===e.type})?"criticalHit":t.every(function(e){return"miss"===e.type})?"attackMiss":"attackRound",this.playEffect(a)}},{key:"handleEnemyDead",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,a=t.enemyDead,n=a.source,r=a.count;this.enemyDeadCount=r,this.playEffect("enemyDead"),n.boss&&setTimeout(function(){e.playEffect("activatePortal")},150)}},{key:"handleOverlayToggle",value:function(e){var t=this.effectOverlays[e]?"openOverlay":"closeOverlay";this.playEffect(t)}},{key:"componentWillMount",value:function(){this.loadEffects()}},{key:"componentDidMount",value:function(){this.playBackgroundSong(this.props.gameLevel,this.props.overlayMode)}},{key:"componentWillUnmount",value:function(){this.state.song.pause()}},{key:"componentWillReceiveProps",value:function(e){var t=this;(this.props.gameLevel!==e.gameLevel||(this.musicOverlays[this.props.overlayMode]||this.musicOverlays[e.overlayMode])&&this.props.overlayMode!==e.overlayMode)&&(1===e.gameLevel&&"off"===e.overlayMode&&this.playEffect("heroSelection"),this.playBackgroundSong(e.gameLevel,e.overlayMode,e)),(this.effectOverlays[this.props.overlayMode]||this.effectOverlays[e.overlayMode])&&this.props.overlayMode!==e.overlayMode&&this.handleOverlayToggle(e.overlayMode),this.props.gameMuted!==e.gameMuted&&this.toggleMute(e.gameMuted),this.props.levelUpCount!==e.levelUpCount&&setTimeout(function(){t.playEffect("levelUp")},100),this.props.interactItem.count!==e.interactItem.count&&this.handleInteractItem(e),this.props.increasedStat.count!==e.increasedStat.count&&this.playEffect("useStatPoint"),this.props.exchangeAttacks.count!==e.exchangeAttacks.count&&this.handleAttackRound(e),e.enemyDead.count!==this.enemyDeadCount&&this.handleEnemyDead(e)}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"render",value:function(){return React.createElement("div",null)}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),GameStage=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.updateAccArr=a.updateAccArr.bind(a),a.state={stageSize:480,accArr:[]},a}return _inherits(t,e),_createClass(t,[{key:"updateAccArr",value:function(e){this.setState({accArr:e})}},{key:"render",value:function(){return React.createElement("div",{className:"stage"},React.createElement(LayerPlayer,{stageSize:this.state.stageSize,tileSize:this.props.tileSize,gameLevel:this.props.gameLevel,bgLevelProcessed:this.props.bgLevelProcessed,hero:this.props.hero,heroFacing:this.props.heroFacing,playerArr:this.props.playerArr,bgArr:this.props.bgArr,floorCoords:this.props.floorCoords,playerPalettes:this.props.playerPalettes,updateGameClassState:this.props.updateGameClassState}),React.createElement(LayerBackground,{boardSize:this.props.boardSize,stageSize:this.state.stageSize,tileSize:this.props.tileSize,gameLevel:this.props.gameLevel,bgLevelProcessed:this.props.bgLevelProcessed,playerArr:this.props.playerArr,bgArr:this.props.bgArr,updateGameClassState:this.props.updateGameClassState}),React.createElement(LayerAccent,{stageSize:this.state.stageSize,boardSize:this.props.boardSize,tileSize:this.props.tileSize,gameLevel:this.props.gameLevel,bgLevelProcessed:this.props.bgLevelProcessed,playerArr:this.props.playerArr,bgArr:this.props.bgArr,accArr:this.state.accArr,enemyDead:this.props.enemyDead,updateAccArr:this.updateAccArr}),React.createElement(LayerItem,{stageSize:this.state.stageSize,boardSize:this.props.boardSize,tileSize:this.props.tileSize,gameLevel:this.props.gameLevel,levels:this.props.levels,bgLevelProcessed:this.props.bgLevelProcessed,playerArr:this.props.playerArr,bgArr:this.props.bgArr,itemArr:this.props.itemArr,floorCoords:this.props.floorCoords,enemyDead:this.props.enemyDead,itemPaletteArrMap:this.props.itemPaletteArrMap,itemPalettes:this.props.itemPalettes,updateGameClassState:this.props.updateGameClassState}),React.createElement(LayerEnemy,{boardSize:this.props.boardSize,stageSize:this.state.stageSize,tileSize:this.props.tileSize,playerArr:this.props.playerArr,enemyArr:this.props.enemyArr,enemyPalettes:this.props.enemyPalettes,updateGameClassState:this.props.updateGameClassState}),React.createElement(LayerDistanceFog,{stageSize:this.state.stageSize,tileSize:this.props.tileSize}),React.createElement(LayerExploreFog,{boardSize:this.props.boardSize,stageSize:this.state.stageSize,tileSize:this.props.tileSize,gameLevel:this.props.gameLevel,playerArr:this.props.playerArr,portalObjective:this.props.portalObjective,updateGameClassState:this.props.updateGameClassState}),React.createElement(LayerOverlays,{tileSize:this.props.tileSize,overlayMode:this.props.overlayMode,playerArr:this.props.playerArr,enemyArr:this.props.enemyArr,inventory:this.props.inventory,interactItem:this.props.interactItem,playerPalettes:this.props.playerPalettes,toggleMute:this.props.toggleMute,updateGameClassState:this.props.updateGameClassState}))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),GameTips=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"tips"},React.createElement("p",null,"Press 'H' for help"),React.createElement("p",null,"Press 'Q' for mute"))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),Hero=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initHero=a.initHero.bind(a),a.changeStats=a.changeStats.bind(a),a.handleLevelUp=a.handleLevelUp.bind(a),a.paintHeroIcon=a.paintHeroIcon.bind(a),a.attemptPurchase=a.attemptPurchase.bind(a),a.sellItem=a.sellItem.bind(a),a.handleInteractItem=a.handleInteractItem.bind(a),a.handleEnemyDead=a.handleEnemyDead.bind(a),a.handleUseStatPoint=a.handleUseStatPoint.bind(a),a.updateEquipCanvas=a.updateEquipCanvas.bind(a),a.handleBattleRound=a.handleBattleRound.bind(a),a.handleHeroDead=a.handleHeroDead.bind(a),a.enemyDeadCount=0,a.heroDead=!1,a.state={heroName:"",experience:0,expToLevel:0,charLevel:0,gold:0,curHealth:0,bHealth:0,bAttack:0,bDefense:0,bHit:0,bCrit:0,bDodge:0,bVitality:0,bDurability:0,bStrength:0,bAgility:0,statPoints:0,onLevelUp:{},head:null,weapon:null,amulet:null,armor:null,shield:null,glove:null,ring:null,foot:null,iHealth:0,iAttack:0,iDefense:0,iHit:0,iCrit:0,iDodge:0,iVitality:0,iDurability:0,iStrength:0,iAgility:0,bExpToLevel:100,interactItemCount:0,battleRound:0,statIncMessages:[]},a}return _inherits(t,e),_createClass(t,[{key:"initHero",value:function(e){var t=Object.assign({},heroTypeStats[e]),a=t.health,n=t.vitality,r=t.durability,o=statConversion,i=["'V'","'B'","'N'","'M'"];this.setState({statIncMessages:i,heroName:t.heroName,charLevel:1,expToLevel:this.state.bExpToLevel,curHealth:a+o.vitToHp*n+o.durToHp*r,bHealth:a,bAttack:t.attack,bDefense:t.defense,bHit:t.hit,bCrit:t.crit,bDodge:t.dodge,bVitality:n,bDurability:r,bStrength:t.strength,bAgility:t.agility,onLevelUp:t.onLevelUp})}},{key:"paintHeroIcon",value:function(e){document.getElementById("hero-icon").getContext("2d").drawImage(e,0,0)}},{key:"changeStats",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object.assign({},e),n=Object.assign({},t),r=Object.assign({},this.state),o=null;for(o in a)r[o]+=a[o];for(o in n)r[o]-=n[o];return r}},{key:"handleLevelUp",value:function(e,t){var a=this.state.onLevelUp,n=this.state.charLevel+1,r=this.state.bHealth+a.health,o=this.state.bVitality+a.vitality,i=this.state.bDurability+a.durability,s=this.state.bStrength+a.strength,l=this.state.bAgility+a.agility,c=this.state.bAttack+a.attack,u=this.state.bDefense+a.defense,p=this.state.iHealth,m=this.state.iVitality,h=this.state.iDurability,y=statConversion,d=r+p+y.vitToHp*(o+m)+y.durToHp*(i+h),b=this.state.statPoints+y.lvlUpSkillPoints,g=this.state.expToLevel;e-=g,g=~~(g*y.expLevelMult),this.props.updateGameClassState({levelUpCount:n}),this.setState({gold:t,charLevel:n,experience:e,expToLevel:g,bHealth:r,bAttack:c,bDefense:u,bVitality:o,bDurability:i,bStrength:s,bAgility:l,statPoints:b,curHealth:d})}},{key:"attemptPurchase",value:function(e,t,a,n){var r=this.state.gold,o=Object.assign({},n),i={};r>=e.buy?(o.type="buySuccess",r-=e.buy,a[e.name].count-=1,t[e.name]?t[e.name].count+=1:(t[e.name]=Object.assign({},e),t[e.name].count=1),i={inventory:t},this.setState({gold:r})):o.type="buyFail",o.count+=1,i.interactItem=o,this.props.updateGameClassState(i)}},{key:"sellItem",value:function(e,t,a,n){var r=this.state.gold,o={gold:r+e.sell};e.equipped&&(t[e.name].equipped=!1,o[e.type]=null),t[e.name].count-=1,a[e.name]?a[e.name].count+=1:(a[e.name]=Object.assign({},e),a[e.name].count=1),0===t[e.name].count&&"consumable"!==t[e.name].type&&this.updateEquipCanvas(t[e.name]),this.setState(o),this.props.updateGameClassState({inventory:t})}},{key:"handleEnemyDead",value:function(e){var t=e.enemyDead,a=this.state,n=a.experience,r=a.expToLevel,o=a.gold;n+=t.experience,o+=t.gold,this.enemyDeadCount=t.count,n>=r?this.handleLevelUp(n,o):this.setState({experience:n,gold:o})}},{key:"handleInteractItem",value:function(e){var t=e.interactItem,a=t.type,n=t.item.name,r=statConversion,o=Object.assign({},e.inventory),i=t.source.inventory,s="buy"===a?i[n]:o[n],l=s.stats,c=s.type,u=!1,p=!1,m=null,h={},y=0,d=0,b=0,g=0;"pickup"===a&&"gold"===s.type?h=this.changeStats(l):"use"===a?(u=!0,s.count-=1,h=this.changeStats(l)):"unequip"===a?(u=!0,p=!0,m=this.state[c],o[m.name].equipped=!1,h=this.changeStats({},m.stats),h[c]=null):"equip"===a?(u=!0,p=!0,m=this.state[c],m?(o[m.name].equipped=!1,h=this.changeStats(l,m.stats)):h=this.changeStats(l),s.equipped=!0,h[c]=s):"buy"===a?this.attemptPurchase(s,o,i,t):"sell"===a&&this.sellItem(s,o,i,t),Object.keys(h).length&&(d=h.bHealth+h.iHealth,b=h.iVitality+h.bVitality,g=h.iDurability+h.bDurability,y=d+r.vitToHp*b+r.durToHp*g,h.curHealth>y&&(h.curHealth=y),p&&this.updateEquipCanvas(s),u&&this.props.updateGameClassState({inventory:o}),this.setState(h))}},{key:"handleUseStatPoint",value:function(e){var t={statPoints:1},a=Object.assign({},e.increasedStat),n={},r={};this.state.statPoints>0&&(n[e.useStatPoint.stat]=1,r=this.changeStats(n,t),a.count++,a.type="Increased",a.stat=e.useStatPoint.stat.slice(1),a.quant=1,this.props.updateGameClassState({increasedStat:a}),this.setState(r))}},{key:"updateEquipCanvas",value:function(e){var t=this.props.itemPalettes[e.palette],a=e.iconLoc,n=getById(e.type+"-canvas").getContext("2d");n.clearRect(0,0,a[2],a[3]),e.equipped&&n.drawImage(t,a[0],a[1],a[2],a[3],0,0,a[2],a[3])}},{key:"handleBattleRound",value:function(e){var t=e.enemyAttack,a=t.stats,n=t.roundCount,r=statConversion,o=this.state.bDurability+this.state.iDurability,i=this.state.bStrength+this.state.iStrength,s=this.state.bAgility+this.state.iAgility,l=this.state.bAttack+this.state.iAttack+r.strToAtk*i,c=this.state.bDefense+this.state.iDefense+r.durToDef*o+r.strToDef*i,u=this.state.bHit+this.state.iHit+r.strToHit*i+r.agiToHit*s,p=this.state.bCrit+this.state.iCrit+r.agiToCrit*s,m=this.state.bDodge+this.state.iDodge+r.durToDodge*o+r.agiToDodge*s,h=a.bDurability,y=a.bStrength,d=a.bAgility,b=a.bAttack+r.strToAtk*y,g=a.bDefense+r.durToDef*h+r.strToDef*y,f=a.bHit+r.strToHit*y+r.agiToHit*d,v=a.bCrit+r.agiToCrit*d,w=a.bDodge+r.durToDodge*h+r.agiToDodge*d,A=Object.assign({},e.exchangeAttacks),C=this.state,P=C.curHealth,S=C.battleRound,k=t.spawnIndex,E=a.curHealth,R=[],D={},I=!1,_="",L=0,O=0,M=0,x=0;if(n!==S){if(randInt(0,100)<u-w){for(x=0;x<l;x++)L+=randInt(r.atkToHpRange[0],r.atkToHpRange[1]);for(x=0;x<g;x++)O+=randInt(r.defToHpRange[0],r.defToHpRange[1]);M=L-O>0?L-O:0,randInt(0,100)<p?(_="critical hit",M*=2):_="hit",D={type:_,damage:M,from:"hero",to:t.source.name}}else k=-1,D={from:"hero",to:t.source.name,type:"miss",damage:0};R.push(D)}if(!(R.length&&d<=s&&R[0].damage>=E)){if(randInt(0,100)<f-m){for(L=0,O=0,x=0;x<b;x++)L+=randInt(r.atkToHpRange[0],r.atkToHpRange[1]);for(x=0;x<c;x++)O+=randInt(r.defToHpRange[0],r.defToHpRange[1]);M=L-O>0?L-O:0,randInt(0,100)<v?(_="critical hit",M*=2):_="hit",D={type:_,damage:M,from:t.source.name,to:"hero"}}else M=0,D={damage:M,from:t.source.name,to:"hero",type:"miss"};P-=D.damage,d<=s?R.push(D):(I=!0,R.unshift(D))}I&&P<=0&&2===R.length&&(R.length=1,k=-1),S<n&&(S=n),A.count++,A.spawnIndex=k,A.attacks=R,this.setState({curHealth:P,battleRound:S}),e.updateGameClassState({exchangeAttacks:A})}},{key:"handleHeroDead",value:function(){this.heroDead=!0,this.props.updateGameClassState({gameOver:!0,overlayMode:"game-over-overlay"}),console.log("GAME OVER")}},{key:"componentWillReceiveProps",value:function(e){""===this.state.heroName&&e.hero&&this.initHero(e.hero),this.props.interactItem.count!==e.interactItem.count&&e.interactItem.count&&this.handleInteractItem(e),this.props.enemyAttack.count!==e.enemyAttack.count&&this.handleBattleRound(e),this.enemyDeadCount!==e.enemyDead.count&&this.handleEnemyDead(e),this.props.useStatPoint.count!==e.useStatPoint.count&&this.handleUseStatPoint(e)}},{key:"componentWillUpdate",value:function(e,t){this.props.heroIcon!==e.heroIcon&&e.heroIcon&&this.paintHeroIcon(e.heroIcon)}},{key:"componentDidUpdate",value:function(e,t){this.state.curHealth<=0&&!this.heroDead&&this.state.heroName&&this.handleHeroDead()}},{key:"render",value:function(){var e=this.props.tileSize,t="None",a=this.state.statIncMessages,n=statConversion,r=this.state.charLevel,o=this.state.curHealth,i=this.state.gold,s=this.state.statPoints,l=this.state.experience,c=this.state.expToLevel,u=this.state.bVitality+this.state.iVitality,p=this.state.bDurability+this.state.iDurability,m=this.state.bStrength+this.state.iStrength,h=this.state.bAgility+this.state.iAgility,y=this.state.bAttack+this.state.iAttack+n.strToAtk*m,d=this.state.bDefense+this.state.iDefense+n.durToDef*p+n.strToDef*m,b=this.state.bHealth+this.state.iHealth+n.vitToHp*u+n.durToHp*p,g=s?"stat-icon icon-plus-squared":"",f=this.state.head?this.state.head.name:t,v=this.state.weapon?this.state.weapon.name:t,w=this.state.amulet?this.state.amulet.name:t,A=this.state.armor?this.state.armor.name:t,C=this.state.shield?this.state.shield.name:t,P=this.state.glove?this.state.glove.name:t,S=this.state.ring?this.state.ring.name:t,k=this.state.foot?this.state.foot.name:t,E="",R="none",D=0,I="",_="none",L="",O=0,M="",x="none";return b&&(E="9em",R="1px solid #000",D=~~(o/b*100),I=D+"%",_=D>70?"rgba(0,255,0,.8)":D>30?"rgba(255,255,0,.8)":"rgba(255,0,0,.7)",L="11.2em",O=~~(l/c*100),M=O+"%",x="rgba(0,164,255,.6)"),React.createElement("div",{className:"hero"},React.createElement("p",{className:"hero-heading"},"Character Info"),React.createElement("div",{className:"hero-type"},React.createElement("canvas",{id:"hero-icon",className:"hero-icon",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Name: ",this.state.heroName),React.createElement("p",null,"Type: ",this.props.hero))),React.createElement("div",{className:"stat-container"},React.createElement("p",{className:"stat-row"},"Level: ",r),React.createElement("p",{className:"stat-row"},"Health: ",React.createElement("span",{className:"hero-health",style:{width:E,border:R}},React.createElement("span",{className:"hero-health-gauge",style:{width:I,background:_}}),React.createElement("span",{className:"hero-health-number"},o,"/",b))),React.createElement("p",{className:"stat-row"},"Exp: ",React.createElement("span",{className:"hero-experience",style:{width:L,border:R}},React.createElement("span",{className:"hero-experience-gauge",style:{width:M,background:x}}),React.createElement("span",{className:"hero-experience-number"},l,"/",c))),React.createElement("p",{className:"stat-row"},"Gold: ",i),React.createElement("p",{className:"stat-row"},"Stat: ",s),React.createElement("p",{className:"stat-row"},"Atk: ",y),React.createElement("p",{className:"stat-row"},"Def: ",d),React.createElement("p",{className:"stat-row"},"Vit: ",React.createElement("span",{className:"changeable-stat"},u),React.createElement("i",{className:g}),React.createElement("span",{className:"stat-note"},s?a[0]:null)),React.createElement("p",{className:"stat-row"},"Dur: ",React.createElement("span",{className:"changeable-stat"},p),React.createElement("i",{className:g}),React.createElement("span",{className:"stat-note"},s?a[1]:null)),React.createElement("p",{className:"stat-row"},"Str: ",React.createElement("span",{className:"changeable-stat"},m),React.createElement("i",{className:g}),React.createElement("span",{className:"stat-note"},s?a[2]:null)),React.createElement("p",{className:"stat-row"},"Agi: ",React.createElement("span",{className:"changeable-stat"},h),React.createElement("i",{className:g}),React.createElement("span",{className:"stat-note"},s?a[3]:null))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"head-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Head"),React.createElement("p",{className:"equip-name"},f))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"weapon-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Weapon"),React.createElement("p",{className:"equip-name"},v))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"amulet-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Amulet"),React.createElement("p",{className:"equip-name"},w))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"armor-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Armor"),React.createElement("p",{className:"equip-name"},A))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"shield-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Shield"),React.createElement("p",{className:"equip-name"},C))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"glove-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Glove"),React.createElement("p",{className:"equip-name"},P))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"ring-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Ring"),React.createElement("p",{className:"equip-name"},S))),React.createElement("div",{className:"equip-row"},React.createElement("canvas",{id:"foot-canvas",className:"equip-canv",width:e,height:e}),React.createElement("div",{className:"stat-col"},React.createElement("p",null,"Foot"),React.createElement("p",{className:"equip-name"},k))))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerAccent=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initAccArr=a.initAccArr.bind(a),a.initTempCanvas=a.initTempCanvas.bind(a),a.getAccImages=a.getAccImages.bind(a),a.initAccPalettes=a.initAccPalettes.bind(a),a.initPaletteMaps=a.initPaletteMaps.bind(a),a.setLevelPalettes=a.setLevelPalettes.bind(a),a.setPaletteArrMap=a.setPaletteArrMap.bind(a),a.setAccArr=a.setAccArr.bind(a),a.handleEnemyDead=a.handleEnemyDead.bind(a),a.drawAccents=a.drawAccents.bind(a),a.enemyDeadCount=0,a.lastRenderFrame=0,a.lastPlayerArr=[],a.state={srcTileSize:16,wallAcc:20,flrAcc:40,decor0:null,decor1:null,ground0:null,ground1:null,ore0:null,ore1:null,dec0Canv:null,dec1Canv:null,grnd0Canv:null,grnd1Canv:null,ore0CanvPalette:null,ore1CanvPalette:null,ore0Canv:null,ore1Canv:null,decorMap:{},groundMap:{},oreMap:{},corpseMap:"",paletteArrMap:{},tempCanv:null,renderArr:[]},a}return _inherits(t,e),_createClass(t,[{key:"initAccArr",value:function(){var e=this.props.boardSize,t=initZeroArray(e);this.props.updateAccArr(t)}},{key:"getAccImages",value:function(){var e=new Image,t=new Image,a=new Image,n=new Image,r=new Image,o=new Image,i=this,s=0,l=function(){6===++s&&(i.setState({decor0:e,decor1:t,ground0:a,ground1:n,ore0:r,ore1:o}),i.initAccPalettes(e,t,a,n,r,o))};e.src="img/accents/Decor0.png",t.src="img/accents/Decor1.png",a.src="img/accents/Ground0.png",n.src="img/accents/Ground1.png",r.src="img/accents/Ore0.png",o.src="img/accents/Ore1.png",e.addEventListener("load",l),t.addEventListener("load",l),a.addEventListener("load",l),n.addEventListener("load",l),r.addEventListener("load",l),o.addEventListener("load",l)}},{key:"initTempCanvas",value:function(){var e=this.props,t=e.stageSize,a=e.tileSize,n=t/a,r=initMemCanvas(t,t,!1),o=initZeroArray(n);this.setState({tempCanv:r,renderArr:o})}},{key:"initPaletteMaps",value:function(){var e=this.props.tileSize,t={},a={},n={},r="",o=0,i=0,s=0,l=0;for(o=8,i=19,s=0;s<i;s++)for(l=0;l<o;l++)t[""+(o*s+l)]=[e*l,e*s];for(o=8,i=7,s=0;s<i;s++)for(l=0;l<o;l++)a[""+(o*s+l)]=[e*l,e*s];for(o=3,i=2,s=0;s<i;s++)for(l=0;l<o;l++)n[""+(o*s+l)]=[e*l,e*s];r="51",this.setPaletteArrMap(this.props.gameLevel,t,a,n),this.setState({decorMap:t,groundMap:a,oreMap:n,corpseMap:r})}},{key:"initAccPalettes",value:function(e,t,a,n,r,o){var i=this.props.tileSize,s=this.state.srcTileSize,l=i/s,c=19*i,u=8*i,p=7*i,m=8*i,h=6*i,y=10*i,d=2*i,b=3*i,g=document.createElement("canvas"),f=g.getContext("2d"),v=document.createElement("canvas"),w=v.getContext("2d"),A=document.createElement("canvas"),C=A.getContext("2d"),P=document.createElement("canvas"),S=P.getContext("2d"),k=document.createElement("canvas"),E=k.getContext("2d"),R=document.createElement("canvas"),D=R.getContext("2d"),I=document.createElement("canvas"),_=I.getContext("2d"),L=document.createElement("canvas"),O=L.getContext("2d"),M=0,x=0;x=2*s,g.width=u,g.height=c,v.width=u,v.height=c,f.imageSmoothingEnabled=!1,w.imageSmoothingEnabled=!1,f.drawImage(e,0,x,u/l,c/l,0,0,u,c),w.drawImage(t,0,x,u/l,c/l,0,0,u,c),x=0,A.width=m,A.height=p,P.width=m,P.height=p,C.imageSmoothingEnabled=!1,S.imageSmoothingEnabled=!1,C.drawImage(a,0,x,m/l,p/l,0,0,m,p),S.drawImage(n,0,x,m/l,p/l,0,0,m,p),x=s,k.width=y,k.height=h,R.width=y,R.height=h,k.imageSmoothingEnabled=!1,R.imageSmoothingEnabled=!1,E.drawImage(r,M,x,y/l,h/l,0,0,y,h),D.drawImage(o,M,x,y/l,h/l,0,0,y,h),M=0,x=4*i,I.width=b,I.height=d,L.width=b,L.height=d,_.imageSmoothingEnabled=!1,O.imageSmoothingEnabled=!1,_.drawImage(k,M,x,b,d,0,0,b,d),O.drawImage(R,M,x,b,d,0,0,b,d),this.setState({dec0Canv:g,dec1Canv:v,grnd0Canv:A,grnd1Canv:P,ore0CanvPalette:k,ore1CanvPalette:R,ore0Canv:I,ore1Canv:L})}},{key:"setLevelPalettes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.gameLevel,t=this.state,a=t.ore0CanvPalette,n=t.ore1CanvPalette,r=t.ore0Canv,o=t.ore1Canv,i=this.props.tileSize,s=r.width,l=r.height,c=10===e?5*i:0,u=1===e?4*i:2===e?2*i:3===e?i:0,p=r.getContext("2d"),m=o.getContext("2d");p.drawImage(a,c,u,s,l,0,0,s,l),m.drawImage(n,c,u,s,l,0,0,s,l),this.setState({ore0Canv:r,ore1Canv:o})}},{key:"setPaletteArrMap",value:function(e,t,a,n){t=t||this.state.decorMap,a=a||this.state.groundMap,n=n||this.state.oreMap;var r={};e&&e<5?r={21:[t[4],"decor"],22:[n[0],"ore"],23:[n[3],"ore"],24:[t[7],"decor"],25:[n[1],"ore"],26:[n[4],"ore"],27:[n[2],"ore"],28:[n[2],"ore"],29:[n[5],"ore"],41:[t[5],"decor"],42:[t[14],"decor"],43:[t[15],"decor"],44:[a[0],"ground"],45:[t[80],"decor"],46:[t[81],"decor"],47:[t[88],"decor"],48:[t[89],"decor"],49:[a[40],"ground"],51:[a[48],"ground"]}:e<10?r={21:[t[0],"decor"],22:[t[48],"decor"],23:[t[49],"decor"],24:[t[2],"decor"],25:[t[2],"decor"],26:[t[7],"decor"],27:[t[3],"decor"],28:[t[3],"decor"],29:[t[3],"decor"],41:[t[1],"decor"],42:[t[72],"decor"],43:[t[74],"decor"],44:[t[76],"decor"],45:[t[82],"decor"],46:[t[83],"decor"],47:[t[90],"decor"],48:[t[91],"decor"],49:[a[40],"ground"],51:[a[48],"ground"]}:10===e&&(r={21:[t[0],"decor"],22:[t[53],"decor"],23:[t[55],"decor"],24:[t[2],"decor"],25:[n[1],"ore"],26:[n[4],"ore"],27:[t[3],"decor"],28:[n[2],"ore"],29:[n[5],"ore"],41:[t[1],"decor"],42:[t[70],"decor"],43:[t[71],"decor"],44:[t[72],"decor"],45:[t[84],"decor"],46:[t[85],"decor"],47:[t[92],"decor"],48:[t[93],"decor"],49:[a[40],"ground"],51:[a[48],"ground"]}),this.setState({paletteArrMap:r})}},{key:"setAccArr",value:function(e){for(var t=e.bgArr,a=this.state.flrAcc,n=this.state.wallAcc,r=t.length,o=[].concat(_toConsumableArray(e.accArr)),i=[0,0,0,0,0,0,0,0],s=0,l=0,c=0,u=0;c<r;){for(;u<r;)l=t[c][u],s=0,l>n&&(i[0]=t[c-1][u-1],i[1]=t[c-1][u],i[2]=t[c-1][u+1],i[3]=t[c][u-1],i[4]=t[c][u+1],i[5]=t[c+1][u-1],i[6]=t[c+1][u],i[7]=t[c+1][u+1],[22,25,27,35].includes(l)&&i[6]>a&&5===randInt(1,12)&&(s=randInt(21,23)),[21,24,25,32].includes(l)&&i[3]>a&&5===randInt(1,15)&&(s=randInt(24,26)),[23,24,27,34].includes(l)&&i[4]>a&&5===randInt(1,15)&&(s=randInt(27,29)),l>a&&7===randInt(1,50)&&(s=randInt(41,49))),o[c][u]=s,u++;u=0,c++}this.props.updateAccArr(o)}},{key:"handleEnemyDead",value:function(e){var t=e.enemyDead,a=this.state.corpseMap,n=t.coord,r=[].concat(_toConsumableArray(e.accArr));r[n[0]][n[1]]=a,this.enemyDeadCount=t.count,this.props.updateAccArr(r)}},{key:"drawAccents",value:function(e){timeRef||(timeRef=e);var t=this.props.playerArr,a=(e-timeRef)%1e3*.06>29?1:0,n=this.lastPlayerArr,r=this.lastRenderFrame;if(t[0]!==n[0]||t[1]!==n[1]||r!==a){this.lastPlayerArr=t.slice(0),this.lastRenderFrame=a;for(var o=this.props,i=o.tileSize,s=o.stageSize,l=o.accArr,c=this.state.paletteArrMap,u=this.state,p=u.dec0Canv,m=u.dec1Canv,h=u.grnd0Canv,y=u.grnd1Canv,d=u.ore0Canv,b=u.ore1Canv,g=s/i,f=l.length,v=this.state.renderArr,w=document.getElementById("acc-layer").getContext("2d"),A=this.state.tempCanv,C=A.getContext("2d"),P=null,S=void 0,k=0,E=0,R=0,D=0,I=0,_=0,L=0,O=calcRenderPadding(t,f,g,i),M=O.startRow,x=O.startCol,T=O.renderArrHeight,H=O.renderArrWidth,j=O.sX,N=O.sY;_<T;){for(;L<H;)v[_][L]=l[M+_][x+L],L++;L=0,_++}for(C.clearRect(0,0,s,s),_=0;_<T;_++)for(L=0;L<H;L++)(I=v[_][L])&&(S=c[""+I],P=1===a?"decor"===S[1]?p:"ore"===S[1]?d:h:"decor"===S[1]?m:"ore"===S[1]?b:y,k=S[0][0],E=S[0][1],R=j+L*i,D=N+_*i,C.drawImage(P,k,E,i,i,R,D,i,i));w.clearRect(0,0,s,s),w.drawImage(A,0,0,s,s)}window.requestAnimationFrame(this.drawAccents)}},{key:"componentWillMount",value:function(){this.getAccImages(),this.initAccArr(),this.initTempCanvas(),this.initPaletteMaps()}},{key:"componentWillReceiveProps",value:function(e){this.props.gameLevel!==e.gameLevel&&(this.setPaletteArrMap(e.gameLevel),this.state.decor0&&this.setLevelPalettes(e.gameLevel)),this.props.bgLevelProcessed!==e.bgLevelProcessed&&this.setAccArr(e),this.enemyDeadCount!==e.enemyDead.count&&this.handleEnemyDead(e)}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.state.dec0Canv||!t.dec0Canv)}},{key:"componentDidUpdate",value:function(e,t){t.dec0Canv!==this.state.dec0Canv&&window.requestAnimationFrame(this.drawAccents)}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.drawAccents)}},{key:"render",value:function(){var e=this.props.stageSize;return React.createElement("canvas",{id:"acc-layer",className:"acc-layer",width:e,height:e})}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerBackground=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initTempCanvas=a.initTempCanvas.bind(a),a.getBgImages=a.getBgImages.bind(a),a.initPaletteMaps=a.initPaletteMaps.bind(a),a.setPalettes=a.setPalettes.bind(a),a.drawBackground=a.drawBackground.bind(a),a.lastPlayerArr=[],a.state={srcTileSize:16,floorImg:null,wallImg:null,floorPalette:{},wallPalette:{},floorPaletteMap:{},wallPaletteMap:{},tempCanv:null,renderArr:[],playerLoc:[]},a}return _inherits(t,e),_createClass(t,[{key:"getBgImages",value:function(){var e=new Image,t=new Image,a=this,n=0,r=function(){2===++n&&(a.setState({floorImg:e,wallImg:t}),a.setPalettes(e,t,a.props.gameLevel))};e.src="img/terrain/Floor.png",t.src="img/terrain/Wall.png",e.addEventListener("load",r),t.addEventListener("load",r)}},{key:"initTempCanvas",value:function(){var e=this.props,t=e.stageSize,a=e.tileSize,n=t/a,r=initMemCanvas(t,t,!1),o=[],i=0;for(o.length=n;i<n;)o[i]=initZeroArray(n),i++;this.setState({tempCanv:r,renderArr:o})}},{key:"initPaletteMaps",value:function(){var e=this.props.tileSize,t={41:[0,0],42:[e,0],43:[2*e,0],44:[0,e],45:[e,e],46:[2*e,e],47:[0,2*e],48:[e,2*e],49:[2*e,2*e],51:[3*e,0],52:[3*e,e],53:[3*e,2*e],54:[4*e,e],55:[5*e,e],56:[6*e,e],57:[5*e,0]},a={21:[0,0],22:[e,0],23:[2*e,0],24:[0,e],25:[0,2*e],26:[e,e],27:[2*e,2*e],31:[4*e,0],32:[3*e,e],33:[4*e,e],34:[5*e,e],35:[4*e,2*e],36:[3*e,0]};this.setState({floorPaletteMap:t,wallPaletteMap:a})}},{key:"setPalettes",value:function(e,t,a){var n=a,r=this.props.tileSize,o=this.state.srcTileSize,i=r/o,s=3*r,l=7*r,c=6*r,u=document.createElement("canvas"),p=u.getContext("2d"),m=document.createElement("canvas"),h=m.getContext("2d"),y=3*o
;y*=1===n?5:2===n?6:3===n?7:4===n?8:5===n?1:n<8?2:n<10?3:10===n?4:1,u.width=l,u.height=s,p.imageSmoothingEnabled=!1,p.drawImage(e,0,y,l/i,s/i,0,0,l,s),m.width=c,m.height=s,h.imageSmoothingEnabled=!1,h.drawImage(t,0,y,c/i,s/i,0,0,c,s),this.setState({floorPalette:{canvas:u,ctx:p},wallPalette:{canvas:m,ctx:h}})}},{key:"drawBackground",value:function(e){var t=this.props.playerArr,a=this.lastPlayerArr;if(t[0]!==a[0]||t[1]!==a[1]){this.lastPlayerArr=t.slice(0);for(var n=this.props.bgArr,r=this.state.floorPalette.canvas,o=this.state.wallPalette.canvas,i=this.state.floorPaletteMap,s=this.state.wallPaletteMap,l=this.props.tileSize,c=this.props.stageSize,u=n.length,p=c/l,m=this.state,h=m.renderArr,y=m.tempCanv,d=document.getElementById("bg-layer").getContext("2d"),b=y.getContext("2d"),g=null,f=null,v=0,w=0,A=0,C=0,P=0,S=calcRenderPadding(t,u,p,l),k=S.startRow,E=S.startCol,R=S.renderArrHeight,D=S.renderArrWidth,I=S.sX,_=S.sY;C<R;){for(;P<D;)h[C][P]=n[k+C][E+P],P++;P=0,C++}for(b.fillRect(0,0,c,c),C=0;C<R;C++)for(P=0;P<D;P++)(v=h[C][P])>10&&(g=v<40?o:r,f=v<40?s:i,w=f[""+v][0],A=f[""+v][1],b.drawImage(g,w,A,l,l,I+P*l,_+C*l,l,l));d.drawImage(y,0,0,c,c)}window.requestAnimationFrame(this.drawBackground)}},{key:"componentWillMount",value:function(){this.getBgImages(),this.initTempCanvas(),this.initPaletteMaps();var e=backgroundArray(this.props.boardSize),t=e.bgArr,a=e.floorCoords,n=this.props.gameLevel;this.props.updateGameClassState({bgArr:t,bgLevelProcessed:n,floorCoords:a})}},{key:"componentWillReceiveProps",value:function(e){if(this.props.gameLevel!==e.gameLevel&&e.gameLevel||0===e.bgLevelProcessed){var t=backgroundArray(this.props.boardSize),a=t.bgArr,n=t.floorCoords,r=e.gameLevel;this.props.updateGameClassState({bgArr:a,bgLevelProcessed:r,floorCoords:n}),this.state.floorImg&&this.setPalettes(this.state.floorImg,this.state.wallImg,e.gameLevel)}}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.state.floorImg||!t.floorImg)}},{key:"componentDidUpdate",value:function(e,t){window.requestAnimationFrame(this.drawBackground)}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.drawBackground)}},{key:"render",value:function(){var e=this.props.stageSize;return React.createElement("canvas",{id:"bg-layer",className:"bg-layer",width:e,height:e})}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerDistanceFog=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.drawDistanceFog=a.drawDistanceFog.bind(a),a.renderPadArr=[3,2,1,0,0,0,1,2,3],a.renderInset=3,a.fogColor="rgba(0,0,0,0.4)",a.smoothingEnabled=!1,a}return _inherits(t,e),_createClass(t,[{key:"drawDistanceFog",value:function(){var e=this.props,t=e.stageSize,a=e.tileSize,n=this.renderInset,r=this.renderPadArr,o=r.length,i=getById("layer-distance-fog").getContext("2d"),s=0,l=0;for(i.fillStyle=this.fogColor,i.imageSmoothingEnabled=this.smoothingEnabled,i.fillRect(0,0,t,t),s=0;s<o;s++)for(l=0;l<o;l++)l>=r[s]&&l<o-r[s]&&i.clearRect(a*(n+l),a*(n+s),a,a)}},{key:"componentDidMount",value:function(){this.drawDistanceFog()}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"render",value:function(){var e=this.props.stageSize;return React.createElement("canvas",{id:"layer-distance-fog",className:"layer-distance-fog",width:e,height:e})}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerEnemy=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initEnemyArr=a.initEnemyArr.bind(a),a.getEnemyImages=a.getEnemyImages.bind(a),a.initTempCanvas=a.initTempCanvas.bind(a),a.setPalettes=a.setPalettes.bind(a),a.drawEnemies=a.drawEnemies.bind(a),a.lastRenderFrame=0,a.lastPlayerArr=[],a.state={srcTileSize:16,images:{},tempCanv:null,renderArr:[],renderPadArr:[3,2,1,0,0,0,1,2,3],renderInset:3,renderLenBase:0,minPadPx:0},a}return _inherits(t,e),_createClass(t,[{key:"initEnemyArr",value:function(){var e=this.props.boardSize,t=initZeroArray(e);this.props.updateGameClassState({enemyArr:t})}},{key:"getEnemyImages",value:function(){var e=this,t={avian0Img:void 0,avian1Img:void 0,demon0Img:void 0,demon1Img:void 0,elemental0Img:void 0,elemental1Img:void 0,humanoid0Img:void 0,humanoid1Img:void 0,reptile0Img:void 0,reptile1Img:void 0,undead0Img:void 0,undead1Img:void 0},a=void 0,n=0,r=0,o=function(){++r===n&&(e.setState({images:t}),e.setPalettes(t))};for(a in t)t[a]=new Image,t[a].src="img/characters/"+a[0].toUpperCase()+a.slice(1,-3)+".png",t[a].addEventListener("load",o),n++}},{key:"initTempCanvas",value:function(){var e=this.props,t=e.stageSize,a=e.tileSize,n=this.state.renderInset,r=t/a-2*n,o=n*a,i=r*a,s=initMemCanvas(i,i,!1),l=[],c=0;for(l.length=r;c<r;)l[c]=initZeroArray(r),c++;this.setState({tempCanv:s,renderArr:l,renderLenBase:r,minPadPx:o,maxRenderSize:i})}},{key:"setPalettes",value:function(e){var t=this.props.tileSize,a=this.state.srcTileSize,n=t/a,r={},o=null,i=null,s=null,l=null,c="",u=0,p=0;for(i in e)l=e[i],c=i.slice(0,-3)+"Palette",u=l.width,p=l.height,o=r,o[c]=document.createElement("canvas"),o[c].width=n*u,o[c].height=n*p,s=o[c].getContext("2d"),s.imageSmoothingEnabled=!1,s.drawImage(l,0,0,u,p,0,0,o[c].width,o[c].height),o[c].imgPixData=s.getImageData(0,0,o[c].width,o[c].height).data;this.props.updateGameClassState({enemyPalettes:r})}},{key:"drawEnemies",value:function(e){timeRef||(timeRef=e);var t=this.props.playerArr,a=(e-timeRef)%1e3*.06>29?1:0,n=this.lastPlayerArr,r=this.lastRenderFrame;if(t[0]!==n[0]||t[1]!==n[1]||r!==a){this.lastPlayerArr=t.slice(0),this.lastRenderFrame=a;var o=this.props,i=o.tileSize,s=o.enemyArr,l=o.enemyPalettes,c=this.state,u=c.renderPadArr,p=c.renderLenBase,m=c.maxRenderSize,h=c.minPadPx,y=s.length,d=this.state.renderArr,b=getById("enemy-layer").getContext("2d"),g=this.state.tempCanv,f=g.getContext("2d"),v=null,w=0,A=0,C=0,P=0,S=0,k=0,E=0,R=0,D=0,I=0,_=0,L=0,O=0,M=0,x=0;for(t[0]<~~(p/2)?(w=0,C=~~(p/2)-t[0]):t[0]+~~(p/2)+1>y?(C=t[0]+~~(p/2)+1-y,w=y-p+C):(w=t[0]-~~(p/2),C=0),t[1]<~~(p/2)?(A=0,P=~~(p/2)-t[1]):t[1]+~~(p/2)+1>y?(P=t[1]+~~(p/2)+1-y,A=y-p+P):(A=t[1]-~~(p/2),P=0),S=p-C,k=p-P;M<S;){for(;x<k;)x>=u[w?M:M+C]&&x<S-u[A?M:M+P]?d[M][x]=s[w+M][A+x]:d[M][x]=0,x++;x=0,M++}for(E=!A&&P?P*i:0,R=!w&&C?C*i:0,f.clearRect(0,0,m,m),M=0;M<S;M++)for(x=0;x<k;x++)(D=d[M][x])&&(v=l[D.palette[a]],I=D.iconLoc[0],_=D.iconLoc[1],L=E+x*i,O=R+M*i,f.drawImage(v,I,_,i,i,L,O,i,i));b.clearRect(h,h,m,m),b.drawImage(g,E,R,k*i,S*i,h+E,h+R,k*i,S*i)}window.requestAnimationFrame(this.drawEnemies)}},{key:"componentWillMount",value:function(){this.getEnemyImages(),this.initEnemyArr(),this.initTempCanvas()}},{key:"shouldComponentUpdate",value:function(e,t){return!(Object.keys(this.props.enemyPalettes).length||!Object.keys(e.enemyPalettes).length)}},{key:"componentDidUpdate",value:function(e,t){window.requestAnimationFrame(this.drawEnemies)}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.drawEnemies)}},{key:"render",value:function(){var e=this.props.stageSize;return React.createElement("canvas",{id:"enemy-layer",className:"enemy-layer",width:e,height:e})}}]),t}(React.Component),_slicedToArray=function(){function e(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw o}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerExploreFog=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initfogState=a.initFogState.bind(a),a.resetFogArr=a.resetFogArr.bind(a),a.clearExploreFog=a.clearExploreFog.bind(a),a.drawExploreFog=a.drawExploreFog.bind(a),a.lastPlayerArr=[],a.smoothingEnabled=!1,a.fogVal=1,a.sightRadius=4,a.sightDecrement=1,a.state={fogArr:[],renderArr:[],fogSquareCanvas:null,tempCanvas:null},a}return _inherits(t,e),_createClass(t,[{key:"initFogState",value:function(){var e=this.state,t=e.fogArr,a=e.renderArr,n=this.props,r=n.stageSize,o=n.boardSize,i=n.tileSize,s=this.fogVal,l=initMemCanvas(i,i,this.smoothingEnabled),c=initMemCanvas(r,r,this.smoothingEnabled),u=l.getContext("2d"),p=r/i,m=0,h=0;for(u.fillRect(0,0,i,i),a=initZeroArray(p),t.length=o;m<o;){for(t[m]=[],t[m].length=o;h<o;)t[m][h]=s,h++;h=0,m++}this.setState({fogArr:t,renderArr:a,fogSquareCanvas:l,tempCanvas:c})}},{key:"clearExploreFog",value:function(e,t,a){var n=this.sightRadius,r=this.sightDecrement,o=_slicedToArray(t,2),i=o[0],s=o[1],l=0,c=0,u=0;for(c=0;c<=n;c++)for(l=c<2?n:n-r*c+1,u=0;u<=l;u++)i+c<a&&s+u<a&&(e[i+c][s+u]=0),c&&i-c>=0&&s+u<a&&(e[i-c][s+u]=0),u&&i+c<a&&s-u>=0&&(e[i+c][s-u]=0),c&&u&&i-c>=0&&s-u>=0&&(e[i-c][s-u]=0);return e}},{key:"resetFogArr",value:function(){var e=this.state.fogArr,t=this.props.boardSize,a=this.fogVal,n=0,r=0;for(e.length=t;n<t;){for(e[n]=[],e[n].length=t;r<t;)e[n][r]=a,r++;r=0,n++}this.setState({fogArr:e})}},{key:"drawExploreFog",value:function(e){var t=this.props.playerArr,a=this.lastPlayerArr;if(t[0]!==a[0]||t[1]!==a[1]){this.lastPlayerArr=t.slice(0);var n=this.state.fogSquareCanvas,r=this.props,o=r.stageSize,i=r.boardSize,s=r.tileSize,l=r.portalObjective,c=o/s,u=this.state,p=u.fogArr,m=u.renderArr,h=u.tempCanvas,y=document.getElementById("layer-explore-fog").getContext("2d"),d=h.getContext("2d"),b=0,g=0,f=0,v=0,w=calcRenderPadding(t,i,c,s),A=w.startRow,C=w.startCol,P=w.renderArrHeight,S=w.renderArrWidth,k=w.sX,E=w.sY;for(p=this.clearExploreFog(p,t,i),f=0;f<P;f++)for(v=0;v<S;v++)m[f][v]=p[A+f][C+v];for(d.clearRect(0,0,o,o),f=0;f<P;f++)for(v=0;v<S;v++)m[f][v]&&(b=k+v*s,g=E+f*s,d.drawImage(n,b,g,s,s));y.clearRect(0,0,o,o),y.drawImage(h,0,0,o,o),p[l.coord[0]][l.coord[1]]||(l.discovered=!0,this.props.updateGameClassState({portalObjective:l})),this.setState({fogArr:p})}window.requestAnimationFrame(this.drawExploreFog)}},{key:"componentDidMount",value:function(){this.initFogState()}},{key:"componentWillReceiveProps",value:function(e){this.props.gameLevel!==e.gameLevel&&this.resetFogArr()}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.state.tempCanvas||!t.tempCanvas)}},{key:"componentDidUpdate",value:function(e,t){window.requestAnimationFrame(this.drawExploreFog)}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.drawExploreFog)}},{key:"render",value:function(){var e=this.props.stageSize;return React.createElement("canvas",{id:"layer-explore-fog",className:"layer-explore-fog",width:e,height:e})}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerItem=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initItemArr=a.initItemArr.bind(a),a.initTempCanvas=a.initTempCanvas.bind(a),a.getItemImages=a.getItemImages.bind(a),a.setPalettes=a.setPalettes.bind(a),a.setPaletteArrMap=a.setPaletteArrMap.bind(a),a.setSpawnQuants=a.setSpawnQuants.bind(a),a.setItemArr=a.setItemArr.bind(a),a.activatePortal=a.activatePortal.bind(a),a.drawItems=a.drawItems.bind(a),a.enemyDeadCount=0,a.levelProcessed=0,a.lastRenderFrame=0,a.lastPlayerArr=[],a.state={srcTileSize:16,itemTypes:[],images:{},spawnQuants:[],tempCanv:null,renderArr:[],portalCoord:[],displayedItems:["consumable","gold","openChest","door"]},a}return _inherits(t,e),_createClass(t,[{key:"initItemArr",value:function(){var e=this.props.boardSize,t=initZeroArray(e);this.props.updateGameClassState({itemArr:t})}},{key:"getItemImages",value:function(){var e=this,t={amuletImg:void 0,armorImg:void 0,bookImg:void 0,bootImg:void 0,chest0Img:void 0,chest1Img:void 0,door0Img:void 0,door1Img:void 0,gloveImg:void 0,hatImg:void 0,longWepImg:void 0,medWepImg:void 0,moneyImg:void 0,potionImg:void 0,ringImg:void 0,shieldImg:void 0,shortWepImg:void 0,wandImg:void 0},a=void 0,n=0,r=0,o=function(){++r===n&&(e.setState({images:t}),e.setPalettes(t))};for(a in t)t[a]=new Image,t[a].src="img/items/"+a[0].toUpperCase()+a.slice(1,-3)+".png",t[a].addEventListener("load",o),n++}},{key:"initTempCanvas",value:function(){var e=this.props,t=e.stageSize,a=e.tileSize,n=t/a,r=initMemCanvas(t,t,!1),o=initZeroArray(n);this.setState({tempCanv:r,renderArr:o})}},{key:"setPalettes",value:function(e){var t=this.props.tileSize,a=this.state.srcTileSize,n=t/a,r={},o=null,i=null,s=null,l=null,c="",u=0,p=0;for(i in e)l=e[i],c=i.slice(0,-3)+"Palette",u=l.width,p=l.height,o=r,o[c]=document.createElement("canvas"),o[c].width=n*u,o[c].height=n*p,s=o[c].getContext("2d"),s.imageSmoothingEnabled=!1,s.drawImage(l,0,0,u,p,0,0,o[c].width,o[c].height),o[c].imgPixData=s.getImageData(0,0,o[c].width,o[c].height).data;this.props.updateGameClassState({itemPalettes:r})}},{key:"setPaletteArrMap",value:function(){var e=[itemAmulets,itemArmors,itemFeet,itemGloves,itemHelmets,itemRings,itemShields,itemWeapons,itemConsumables,chestConsumables,interactivePortals],t={},a=101,n=null;e.forEach(function(e){for(n in e)e[n].itemArrVal=a,t[""+a]=e[n],a++}),this.setSpawnQuants(e),this.setState({itemTypes:e}),this.props.updateGameClassState({itemPaletteArrMap:t})}},{key:"setSpawnQuants",value:function(e){var t=this.props.levels,a=[],n=[],r={},o=null,i=0,s=0,l=0;for(a.length=t;l<t;)a[l]=[],l++;e.forEach(function(e){for(o in e){r=e[o],s=r.itemArrVal;for(i in r.spawnQuant)n=[s,r.spawnQuant[i]],a[1*i-1].push(n)}}),this.setState({spawnQuants:a})}},{key:"setItemArr",value:function(e,t){for(var a=t.spawnQuants,n=e.gameLevel,r=e.bgArr,o=[].concat(_toConsumableArray(e.itemArr)),i=[].concat(_toConsumableArray(e.floorCoords)),s=o.length,l=i.length,c=[],u=0,p=0,m=0,h=0;m<s;){for(;h<s;)o[m][h]=0,h++;h=0,m++}for(a[n-1].forEach(function(e){for(m=0;m<e[1];m++)u=randInt(0,l-1),c=i[u],o[c[0]][c[1]]=e[0],i.splice(u,1),l--});42!==p;)u=randInt(0,l-1),c=i[u],p=r[c[0]][c[1]];c[0]--,o[c[0]][c[1]]=interactivePortals.inactivePortal.itemArrVal,this.setState({portalCoord:c}),this.props.updateGameClassState({floorCoords:i,itemArr:o,itemLevelProcessed:n,portalObjective:{coord:c,discovered:!1}})}},{key:"activatePortal",value:function(){var e=this.state.portalCoord,t=interactivePortals.activePortal,a=[].concat(_toConsumableArray(this.props.itemArr));a[e[0]][e[1]]=t.itemArrVal,this.props.updateGameClassState({itemArr:a})}},{key:"drawItems",value:function(e){timeRef||(timeRef=e);var t=this.props.playerArr,a=(e-timeRef)%1e3*.06>29?1:0,n=this.lastPlayerArr,r=this.lastRenderFrame;if(t[0]!==n[0]||t[1]!==n[1]||r!==a){this.lastPlayerArr=t.slice(0),this.lastRenderFrame=a;for(var o=this.props,i=o.tileSize,s=o.stageSize,l=o.itemArr,c=o.itemPaletteArrMap,u=o.itemPalettes,p=this.state.displayedItems,m=l.length,h=s/i,y=this.state,d=y.renderArr,b=y.tempCanv,g=document.getElementById("item-layer").getContext("2d"),f=b.getContext("2d"),v="",w=null,A=void 0,C=0,P=0,S=0,k=0,E=0,R=0,D=0,I=calcRenderPadding(t,m,h,i),_=I.startRow,L=I.startCol,O=I.renderArrHeight,M=I.renderArrWidth,x=I.sX,T=I.sY;R<O;){for(;D<M;)d[R][D]=l[_+R][L+D],D++;D=0,R++}for(f.clearRect(0,0,s,s),R=0;R<O;R++)for(D=0;D<M;D++)(C=d[R][D])&&(A=p.includes(c[""+C].type)?c[""+C]:chestConsumables.closedChest,v="door"===A.type?A.palette[a]:A.palette,w=u[v],P=A.iconLoc[0],S=A.iconLoc[1],k=x+D*i,E=T+R*i,f.drawImage(w,P,S,i,i,k,E,i,i));g.clearRect(0,0,s,s),g.drawImage(b,0,0,s,s)}window.requestAnimationFrame(this.drawItems)}},{key:"componentWillMount",value:function(){this.getItemImages(),this.initItemArr(),this.initTempCanvas(),this.setPaletteArrMap()}},{key:"componentWillUpdate",value:function(e,t){this.levelProcessed===e.bgLevelProcessed||this.props.playerArr[0]===e.playerArr[0]&&this.props.playerArr[1]===e.playerArr[1]||(this.levelProcessed=e.bgLevelProcessed,this.setItemArr(e,t)),e.enemyDead.count!==this.enemyDeadCount&&(this.enemyDeadCount=e.enemyDead.count,e.enemyDead.source.boss&&this.activatePortal())}},{key:"componentDidUpdate",value:function(e,t){Object.keys(e.itemPalettes).length!==Object.keys(this.props.itemPalettes).length&&Object.keys(this.props.itemPalettes).length&&window.requestAnimationFrame(this.drawItems)}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.drawItems)}},{key:"render",value:function(){var e=this.props.stageSize;return React.createElement("canvas",{id:"item-layer",className:"item-layer",width:e,height:e})}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerOverlays=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.overlayMode!==e.overlayMode||"off"!==this.props.overlayMode}},{key:"render",value:function(){var e=this.props.overlayMode,t=null;return"inv-overlay"===e?t=React.createElement(OverlayInventory,{inventory:this.props.inventory,interactItem:this.props.interactItem,toggleMute:this.props.toggleMute,updateGameClassState:this.props.updateGameClassState}):"help-overlay"===e?t=React.createElement(OverlayHelp,{toggleMute:this.props.toggleMute,updateGameClassState:this.props.updateGameClassState}):"merchant-overlay"===e?t=React.createElement(OverlayMerchant,{playerArr:this.props.playerArr,enemyArr:this.props.enemyArr,inventory:this.props.inventory,interactItem:this.props.interactItem,toggleMute:this.props.toggleMute,updateGameClassState:this.props.updateGameClassState}):"game-over-overlay"===e?t=React.createElement(OverlayGameOver,{toggleMute:this.props.toggleMute,updateGameClassState:this.props.updateGameClassState}):"game-win-overlay"===e?t=React.createElement(OverlayGameWin,{toggleMute:this.props.toggleMute,updateGameClassState:this.props.updateGameClassState}):"hero-selection-overlay"===e&&(t=React.createElement(OverlayHeroSelection,{tileSize:this.props.tileSize,playerPalettes:this.props.playerPalettes,toggleMute:this.props.toggleMute,updateGameClassState:this.props.updateGameClassState})),React.createElement("div",null,t)}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),LayerPlayer=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.getPlayerImages=a.getPlayerImages.bind(a),a.setPalettes=a.setPalettes.bind(a),a.setHeroIcon=a.setHeroIcon.bind(a),a.pickPlayerStart=a.pickPlayerStart.bind(a),a.drawPlayer=a.drawPlayer.bind(a),a.drawingStart=!1,a.startHeroIcon=!1,a.state={srcTileSize:16,mageImg:null,rogueImg:null,paladinImg:null,warriorImg:null,images:{}},a}return _inherits(t,e),_createClass(t,[{key:"getPlayerImages",value:function(){var e=new Image,t=new Image,a=new Image,n=new Image,r=this,o={},i=0,s=function(){4===++i&&(o={mageImg:e,rogueImg:t,paladinImg:a,warriorImg:n},r.setState(o,r.setPalettes(o)))};e.src="img/heroes/Mage.png",t.src="img/heroes/Rogue.png",a.src="img/heroes/Paladin.png",n.src="img/heroes/Warrior.png",e.addEventListener("load",s),t.addEventListener("load",s),a.addEventListener("load",s),n.addEventListener("load",s)}},{key:"setPalettes",value:function(e){var t=this.state.srcTileSize,a=this.props.tileSize,n=a/t,r=4*a,o=4*a,i={},s=null,l=null,c=null;for(c in e)s=document.createElement("canvas"),s.width=r,s.height=o,l=s.getContext("2d"),l.imageSmoothingEnabled=!1,l.drawImage(e[c],0,0,r/n,o/n,0,0,r,o),i[c]=s;this.props.updateGameClassState({playerPalettes:i})}},{key:"setHeroIcon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=e.playerPalettes,a=e.hero.toLowerCase()+"Img",n=e.tileSize,r=n,o=document.createElement("canvas"),i=null;o.width=n,o.height=r,i=o.getContext("2d"),i.imageSmoothingEnabled=!1,i.drawImage(t[a],0,0,n,r,0,0,n,r),e.updateGameClassState({heroIcon:o})}},{key:"pickPlayerStart",value:function(e){var t=e.floorCoords,a=randInt(0,e.floorCoords.length-1),n=t[a];t=t.filter(function(e){return Math.abs(e[0]-n[0])+Math.abs(e[1]-n[1])>8}),this.props.updateGameClassState({playerArr:n,floorCoords:t})}},{key:"drawPlayer",value:function(e){timeRef||(timeRef=e);var t=this.props.playerPalettes[this.props.hero.toLowerCase()+"Img"],a=this.props.tileSize,n=this.props.heroFacing,r=(this.props.stageSize-a)/2,o=r,i="down"===n?0:"left"===n?1:"right"===n?2:3,s=Math.floor((e-timeRef)%1e3*.06/15),l=document.getElementById("player-layer"),c=l.getContext("2d");c.clearRect(r,o,a,a),c.drawImage(t,s*a,i*a,a,a,r,o,a,a),window.requestAnimationFrame(this.drawPlayer)}},{key:"componentWillMount",value:function(){this.getPlayerImages()}},{key:"componentWillReceiveProps",value:function(e){this.props.bgLevelProcessed!==e.bgLevelProcessed&&this.pickPlayerStart(e),!e.heroIcon&&!this.startHeroIcon&&e.hero&&e.playerPalettes[e.hero.toLowerCase()+"Img"]&&(this.startHeroIcon=!0,this.setHeroIcon(e))}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.drawingStart||!e.hero||!e.playerPalettes[this.props.hero.toLowerCase()+"Img"])&&(this.drawingStart=!0,!0)}},{key:"componentDidUpdate",value:function(e,t){window.requestAnimationFrame(this.drawPlayer)}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.drawPlayer)}},{key:"render",value:function(){var e=this.props.stageSize;return React.createElement("canvas",{id:"player-layer",className:"player-layer",width:e,height:e})}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),OverlayGameOver=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initOverlay=a.initOverlay.bind(a),a.optKeyDown=a.optKeyDown.bind(a),a.focus=a.focus.bind(a),a.state={gameOverMessage:"",focusClass:"optFocus"},a}return _inherits(t,e),_createClass(t,[{key:"initOverlay",value:function(){this.setState({gameOverMessage:"You have failed. Your village was overrun by the evil horde. There were no survivors."})}},{key:"optKeyDown",value:function(e){var t=e.nativeEvent.code;"Space"===t||"Enter"===t||"NumpadEnter"===t||"Escape"===t?this.props.updateGameClassState({overlayMode:"hero-selection-overlay"}):"KeyQ"!==t&&"KeyP"!==t||this.props.toggleMute()}},{key:"focus",value:function(){ReactDOM.findDOMNode(this).focus()}},{key:"componentWillMount",value:function(){this.initOverlay()}},{key:"componentDidMount",value:function(){var e=this;this.focus(),this.focusID=setInterval(function(){return e.focus()},250)}},{key:"componentWillUnmount",value:function(){clearInterval(this.focusID)}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"render",value:function(){var e=this.state,t=e.gameOverMessage,a=e.focusClass;return React.createElement("div",{id:"game-over-overlay",className:"stage-overlay",tabIndex:"1",onKeyDown:this.optKeyDown},React.createElement("h4",{className:"game-over-header"},"GAME OVER"),React.createElement("div",{className:"game-over-message"},t),React.createElement("div",{className:"game-over-row "+a},"Try Again?"))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),OverlayGameWin=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initOverlay=a.initOverlay.bind(a),a.optKeyDown=a.optKeyDown.bind(a),a.focus=a.focus.bind(a),a.state={gameOverMessage:"",focusClass:"optFocus"},a}return _inherits(t,e),_createClass(t,[{key:"initOverlay",value:function(){this.setState({gameOverMessage:"The Evil Lords have been crushed. The minions that remain cower from your fury. The evil hordes scatter. Your village will surely rejoice upon your return."})}},{key:"optKeyDown",value:function(e){var t=e.nativeEvent.code;"Space"===t||"Enter"===t||"Escape"===t?this.props.updateGameClassState({overlayMode:"hero-selection-overlay"}):"KeyQ"!==t&&"KeyP"!==t||this.props.toggleMute()}},{key:"focus",value:function(){ReactDOM.findDOMNode(this).focus()}},{key:"componentWillMount",value:function(){this.initOverlay()}},{key:"componentDidMount",value:function(){var e=this;this.focus(),this.focusID=setInterval(function(){return e.focus()},250)}},{key:"componentWillUnmount",value:function(){clearInterval(this.focusID)}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"render",value:function(){var e=this.state,t=e.gameOverMessage,a=e.focusClass;return React.createElement("div",{id:"game-over-overlay",className:"stage-overlay",tabIndex:"1",onKeyDown:this.optKeyDown},React.createElement("h4",{className:"game-over-header"},"YOU ARE VICTORIOUS"),React.createElement("div",{className:"game-over-message"},t),React.createElement("div",{className:"game-over-row "+a},"Play Again?"))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),OverlayHelp=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initOverlay=a.initOverlay.bind(a),a.optKeyDown=a.optKeyDown.bind(a),a.focus=a.focus.bind(a),a.maintainFocus=a.maintainFocus.bind(a),a.endFocus=a.endFocus.bind(a),a.state={helpMessage:""},a}return _inherits(t,e),_createClass(t,[{key:"initOverlay",value:function(){this.setState({helpMessage:"Items enclosed in quotes ('') denote key mappings."})}},{key:"optKeyDown",value:function(e){var t=e.nativeEvent.code;"KeyH"===t||"Space"===t||"Enter"===t||"Escape"===t?this.props.updateGameClassState({overlayMode:"off"}):"KeyQ"!==t&&"KeyP"!==t||this.props.toggleMute()}},{key:"focus",value:function(){ReactDOM.findDOMNode(this).focus()}},{key:"maintainFocus",value:function(){var e=this;this.focus(),this.focusID=setInterval(function(){return e.focus()},250)}},{key:"endFocus",value:function(){clearInterval(this.focusID)}},{key:"componentWillMount",value:function(){this.initOverlay()}},{key:"componentDidMount",value:function(){this.maintainFocus()}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"componentWillUnmount",value:function(){this.endFocus()}},{key:"render",value:function(){var e=this.state.helpMessage;return React.createElement("div",{id:"help-overlay",className:"stage-overlay",tabIndex:"1",onKeyDown:this.optKeyDown},React.createElement("h4",{className:"game-over-header"},"HELP"),React.createElement("div",{className:"game-over-message"},e),React.createElement("div",{className:"help-details"},React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"ACTION"),React.createElement("span",null,"KEY MAP")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Move Up:"),React.createElement("span",null,"'W' or 'ArrowUp'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Move Down:"),React.createElement("span",null,"'S' or 'ArrowDown'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Move Left:"),React.createElement("span",null,"'A' or 'ArrowLeft'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Move Right:"),React.createElement("span",null,"'D' or 'ArrowRight'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Enter:"),React.createElement("span",null,"'Enter' or 'SpaceBar'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Use Stat Point:"),React.createElement("span",null,"'V', 'B', 'N', 'M'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"QuickConsume Items:"),React.createElement("span",null,"Numbers '1' through '8'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Toggle Inventory:"),React.createElement("span",null,"'I' or 'E'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Toggle Help:"),React.createElement("span",null,"'H'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Toggle Mute:"),React.createElement("span",null,"'Q' or 'P'")),React.createElement("p",{className:"help-row"},React.createElement("span",{className:"help-action"},"Toggle Buy/Sell:"),React.createElement("span",null,"'Y'/'U' (In Merch Screen)"))))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),OverlayHeroSelection=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.initOverlay=a.initOverlay.bind(a),a.optKeyDown=a.optKeyDown.bind(a),a.focus=a.focus.bind(a),a.state={heroTypes:[],heroSelectionMessage:"",currentSelection:""},a}return _inherits(t,e),_createClass(t,[{key:"initOverlay",value:function(){var e=[],t="",a="";for(t in heroTypeStats)e.push(t);a=e[0],this.setState({heroTypes:e,heroSelectionMessage:"It was a stroke of luck to have intercepted their plot. The evil horde is gathering strength to sweep across your homeland. Your only hope is a preemptive strike at their very heart. Choose your hero wisely",currentSelection:a})}},{key:"optKeyDown",value:function(e){var t=this.state.heroTypes,a=e.nativeEvent.code,n=this.state.currentSelection,r=t.indexOf(n);"ArrowUp"===a&&r>0||"ArrowDown"===a&&r<t.length-1?(r="ArrowUp"===a?r-1:r+1,n=t[r],this.setState({currentSelection:n})):"Space"===a||"Enter"===a||"NumpadEnter"===a?this.props.updateGameClassState({hero:n}):"KeyQ"!==a&&"KeyP"!==a||this.props.toggleMute()}},{key:"focus",value:function(){ReactDOM.findDOMNode(this).focus()}},{key:"componentWillMount",value:function(){this.initOverlay()}},{key:"componentDidMount",value:function(){var e=this
;this.focus(),this.focusID=setInterval(function(){return e.focus()},250)}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.state.currentSelection===t.currentSelection&&(Object.keys(this.props.playerPalettes).length||!Object.keys(e.playerPalettes).length))}},{key:"componentWillUnmount",value:function(){clearInterval(this.focusID)}},{key:"render",value:function(){var e=this,t=this.state,a=t.heroTypes,n=t.heroSelectionMessage,r=t.currentSelection,o=this.props.playerPalettes[r.toLowerCase()+"Img"]?this.props.playerPalettes:null,i=a.map(function(t,a){return React.createElement(OverlayHeroSelectionRow,{tileSize:e.props.tileSize,heroType:t,playerPalettes:o,key:t+a,position:a,currentSelection:r})});return React.createElement("div",{id:"hero-selection-overlay",className:"stage-overlay",tabIndex:"1",onKeyDown:this.optKeyDown},React.createElement("h4",{className:"hero-selection-header"},"CHOOSE YOUR FATE"),React.createElement("div",{className:"hero-selection-message"},n),i)}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),OverlayHeroSelectionRow=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.drawIcon=a.drawIcon.bind(a),a.canvasId="hero-icon",a.iconDrawn=!1,a.state={},a}return _inherits(t,e),_createClass(t,[{key:"drawIcon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;this.iconDrawn=!0;var t=e.position,a=e.heroType,n=e.playerPalettes,r=e.tileSize,o=n[a.toLowerCase()+"Img"];getById(this.canvasId+t).getContext("2d").drawImage(o,0,0,r,r,0,0,r,r)}},{key:"componentDidMount",value:function(){null!=this.props.playerPalettes&&this.props.playerPalettes[this.props.heroType.toLowerCase()+"Img"]&&this.drawIcon()}},{key:"componentWillReceiveProps",value:function(e){!this.iconDrawn&&null!=e.playerPalettes&&e.playerPalettes[e.heroType.toLowerCase()+"Img"]&&this.drawIcon(e)}},{key:"shouldComponentUpdate",value:function(e,t){return this.propscurrentSelection!==e.currentSelection}},{key:"render",value:function(){var e=this.props,t=e.position,a=e.heroType,n=e.currentSelection,r=e.tileSize,o=heroTypeStats[a],i=a===n?"hero-selection-row hero-selection-focus":"hero-selection-row";return React.createElement("div",{className:i},React.createElement("canvas",{id:this.canvasId+t,className:"hero-selection-canvas",width:r,height:r}),React.createElement("div",{className:"hero-description"},React.createElement("div",{className:"label-col"},React.createElement("p",null,"Name:"),React.createElement("p",null,"Type:"),React.createElement("p",null,"Desc:")),React.createElement("div",{className:"info-col"},React.createElement("p",null,o.heroName),React.createElement("p",null,a),React.createElement("p",null,o.description))))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),OverlayInventory=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.optKeyDown=a.optKeyDown.bind(a),a.updateOptFocus=a.updateOptFocus.bind(a),a.setList=a.setList.bind(a),a.focus=a.focus.bind(a),a.handleInteractItem=a.handleInteractItem.bind(a),a.state={invCategories:["Head","Amulet","Weapon","Armor","Shield","Glove","Ring","Foot","Consumable"],bRowId:"item-row",bColId:"item-col",focusClass:"optFocus",row:0,col:0},a}return _inherits(t,e),_createClass(t,[{key:"optKeyDown",value:function(e){var t=e.nativeEvent.code,a=this.state.invCategories,n=a.length,r=this.state,o=r.row,i=r.col,s=[];if(("ArrowUp"===t||"KeyW"===t)&&o>0)s=[-1,0];else if(("ArrowRight"===t||"KeyD"===t)&&i<n-1)s=[0,1];else if("ArrowDown"===t||"KeyS"===t)s=[1,0];else if(("ArrowLeft"===t||"KeyA"===t)&&i>0)s=[0,-1];else if("KeyI"===t||"KeyE"===t||"Escape"===t)this.props.updateGameClassState({overlayMode:"off"});else if("Space"!==t&&"Enter"!==t&&"Numpad Enter"!=t||!getById(this.state.bRowId+this.state.row))"KeyQ"!==t&&"KeyP"!==t||this.props.toggleMute();else{var l=getById(this.state.bRowId+o).querySelectorAll("span")[1].innerText;this.state.invCategories[this.state.col].toLowerCase();this.handleInteractItem(l)}s.length>0&&this.updateOptFocus([o,i],s)}},{key:"updateOptFocus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[this.state.bRowId,this.state.bColId],n=!1,r="",o={};return 0!==t[1]?(o.row=0,r=e[1]+t[1],getById(a[1]+r)&&(o.col=r)):(r=e[0]+t[0],getById(a[0]+r)&&(o.row=r)),o.hasOwnProperty("row")&&(n=!0,this.setState(o)),n}},{key:"focus",value:function(){ReactDOM.findDOMNode(this).focus()}},{key:"setList",value:function(e,t){var a=statConvertWordMap,n=[],r=null,o=null,i=null,s="",l="";for(r in e)if(e[r].type===t&&e[r].count>0){i=e[r],l="";for(o in i.stats)l+=""+a[o]+i.stats[o]+" ";"consumable"===i.type?n.push([i.count,i.name,l,i.buy]):(s=i.equipped?"E":" ",n.push([s,i.name,l,i.buy]))}return n.sort(function(e,t){return e[3]!==t[3]?t[3]-e[3]:e[1]<t[1]?-1:1}),n}},{key:"setItems",value:function(e,t,a){var n=this,r=this.state.row,o="";return[].concat(_toConsumableArray(Array(e.length))).map(function(i,s){return o=s===r?a+" "+n.state.focusClass:a,React.createElement("div",{id:a+s,className:o,key:e[s][1]},React.createElement("span",{className:t[0].toLowerCase()+"-col",key:e[s][0]},e[s][0]),React.createElement("span",{className:t[1].toLowerCase()+"-col",key:e[s][1]+"-col"},e[s][1]),React.createElement("span",{className:t[2].toLowerCase()+"-col",key:e[s][2]},e[s][2]))})}},{key:"handleInteractItem",value:function(e){var t=this.props.inventory[e],a=this.state.invCategories,n=Object.assign({},this.props.interactItem),r="";r=t.type===a[a.length-1].toLowerCase()?"use":t.equipped?"unequip":"equip",n.count+=1,n.type=r,n.item=t,this.props.updateGameClassState({interactItem:n})}},{key:"componentDidMount",value:function(){var e=this;this.focus(),this.focusID=setInterval(function(){return e.focus()},250)}},{key:"componentWillUnmount",value:function(){clearInterval(this.focusID)}},{key:"render",value:function(){var e=[].concat(_toConsumableArray(this.state.invCategories)),t=this.state,a=(t.row,t.col),n=t.bRowId,r=t.bColId,o=t.focusClass,i=e[a].toLowerCase(),s=this.props.inventory,l=equipAbbrevMap,c=null,u=null,p=null,m="",h="consumable"===i?["Quantity","Name","Stats"]:["Equipped","Name","Stats"],y=this.setList(s,i);return c=e.map(function(e,t){return m=t===a?r+" "+o:r,React.createElement("span",{id:r+t,className:m,key:e},l[e])}),u=[].concat(_toConsumableArray(Array(h.length))).map(function(e,t){return React.createElement("span",{className:"item-header item-header-"+t,key:h[t]},h[t])}),p=this.setItems(y,h,n),React.createElement("div",{id:"inv-overlay",className:"stage-overlay",tabIndex:"1",onKeyDown:this.optKeyDown},React.createElement("h4",{className:"inv-header"},"Inventory"),React.createElement("div",{className:"inv-categories"},c),React.createElement("div",{className:"item-list"},React.createElement("div",{className:"iheader-row"},u),p))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),OverlayMerchant=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.setSource=a.setSource.bind(a),a.optKeyDown=a.optKeyDown.bind(a),a.updateOptFocus=a.updateOptFocus.bind(a),a.setList=a.setList.bind(a),a.focus=a.focus.bind(a),a.handleInteractItem=a.handleInteractItem.bind(a),a.state={source:{},interactCategories:["Buy","Sell"],invCategories:["Head","Amulet","Weapon","Armor","Shield","Glove","Ring","Foot","Consumable"],colNames:["Quant/Buy/Sell","Name","Stats"],bInteractId:"interact-type",bRowId:"item-row",bColId:"item-col",focusClass:"optFocus",interactCategory:"Buy",row:0,col:0},a}return _inherits(t,e),_createClass(t,[{key:"setSource",value:function(){var e=this.props,t=e.playerArr,a=e.enemyArr,n={},r={};[[t[0]-1,t[1]],[t[0],t[1]+1],[t[0]+1,t[1]],[t[0],t[1]-1]].forEach(function(e){(n=a[e[0]][e[1]])&&"merchant"===n.type&&(r=n)}),this.setState({source:r})}},{key:"optKeyDown",value:function(e){var t=e.nativeEvent.code,a=this.state.invCategories,n=a.length,r=this.state,o=r.row,i=r.col,s=r.interactCategories,l=r.interactCategory,c=[];if(("ArrowUp"===t||"KeyW"===t)&&o>0)c=[-1,0];else if(("ArrowRight"===t||"KeyD"===t)&&i<n-1)c=[0,1];else if("ArrowDown"===t||"KeyS"===t)c=[1,0];else if(("ArrowLeft"===t||"KeyA"===t)&&i>0)c=[0,-1];else if("KeyY"===t&&l!==s[0])this.setState({row:0,interactCategory:s[0]});else if("KeyU"===t&&l!==s[1])this.setState({row:0,interactCategory:s[1]});else if("KeyI"===t||"KeyE"===t||"Escape"===t)this.props.updateGameClassState({overlayMode:"off"});else if("Space"!==t&&"Enter"!==t&&"NumpadEnter"!==t||!getById(this.state.bRowId+this.state.row))"KeyQ"!==t&&"KeyP"!==t||this.props.toggleMute();else{var u=getById(this.state.bRowId+o).querySelectorAll("span")[1].id;this.state.invCategories[this.state.col].toLowerCase();this.handleInteractItem(u)}c.length>0&&this.updateOptFocus([o,i],c)}},{key:"updateOptFocus",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=[this.state.bRowId,this.state.bColId],n=!1,r="",o={};return 0!==t[1]?(o.row=0,r=e[1]+t[1],getById(a[1]+r)&&(o.col=r)):(r=e[0]+t[0],getById(a[0]+r)&&(o.row=r)),o.hasOwnProperty("row")&&(n=!0,this.setState(o)),n}},{key:"focus",value:function(){ReactDOM.findDOMNode(this).focus()}},{key:"setList",value:function(e,t){var a=statConvertWordMap,n=[],r=null,o=null,i=null,s="",l="",c=0,u=0;for(r in e)if(e[r].type===t&&e[r].count>0){i=e[r],l=i.count+"/"+i.buy+"/"+i.sell,s="";for(o in i.stats)s+=""+a[o]+i.stats[o]+" ";n.push([l,i.name,s,r])}return n.sort(function(e,t){return c=1*e[0].split("/")[1],u=1*t[0].split("/")[1],c!==u?u-c:e[1]<t[1]?-1:1})}},{key:"setItems",value:function(e,t,a){var n=this,r=this.state.row,o="";return[].concat(_toConsumableArray(Array(e.length))).map(function(i,s){return o=s===r?a+" "+n.state.focusClass:a,React.createElement("div",{id:a+s,className:o,key:e[s][1]},React.createElement("span",{className:t[0].toLowerCase().replace(/\//g,"-")+"-col",key:e[s][0]+s},e[s][0]),React.createElement("span",{id:e[s][3],className:t[1].toLowerCase()+"-col",key:e[s][1]+"-col"},e[s][1]),React.createElement("span",{className:t[2].toLowerCase()+"-col",key:e[s][2]+s},e[s][2]))})}},{key:"handleInteractItem",value:function(e){var t=this.state,a=t.interactCategories,n=t.interactCategory,r=t.source,o=Object.assign({},this.props.interactItem),i={},s="";n===a[0]?(s=a[0].toLowerCase(),i=r.inventory[e]):(s=a[1].toLowerCase(),i=this.props.inventory[e]),o.count+=1,o.type=s,o.item=i,o.source=r,this.props.updateGameClassState({interactItem:o})}},{key:"componentWillMount",value:function(){this.setSource()}},{key:"componentDidMount",value:function(){var e=this;this.focus(),this.focusID=setInterval(function(){return e.focus()},250)}},{key:"shouldComponentUpdate",value:function(e,t){return this.state.interactCategory!==t.interactCategory||this.state.row!==t.row||this.state.col!==t.col||this.props.interactItem.count!==e.interactItem.count}},{key:"componentWillUnmount",value:function(){clearInterval(this.focusID)}},{key:"render",value:function(){var e=[].concat(_toConsumableArray(this.state.invCategories)),t=this.state,a=(t.row,t.col),n=t.bInteractId,r=t.bRowId,o=t.bColId,i=t.focusClass,s=t.interactCategories,l=t.interactCategory,c=t.colNames,u=t.source,p=e[a].toLowerCase(),m=l===s[0]?u.inventory:this.props.inventory,h=equipAbbrevMap,y=null,d=null,b=null,g=null,f="",v=this.setList(m,p);return y=s.map(function(e,t){return f=e===l?n+" "+i:n,React.createElement("span",{className:f,key:e+t},e)}),d=e.map(function(e,t){return f=t===a?o+" "+i:o,React.createElement("span",{id:o+t,className:f,key:e},h[e])}),b=[].concat(_toConsumableArray(Array(c.length))).map(function(e,t){return React.createElement("span",{className:"item-header item-header-"+t,key:c[t]},c[t])}),g=this.setItems(v,c,r),React.createElement("div",{id:"merchant-overlay",className:"stage-overlay",tabIndex:"1",onKeyDown:this.optKeyDown},React.createElement("h4",{className:"merchant-header"},y),React.createElement("div",{className:"inv-categories"},d),React.createElement("div",{className:"item-list"},React.createElement("div",{className:"iheader-row"},b),g))}}]),t}(React.Component),_createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),Game=function(e){function t(e){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.resetGame=a.resetGame.bind(a),a.toggleMute=a.toggleMute.bind(a),a.handleKeyDown=a.handleKeyDown.bind(a),a.updateGameClassState=a.updateGameClassState.bind(a),a.pickupItem=a.pickupItem.bind(a),a.focus=a.focus.bind(a),a.maintainFocus=a.maintainFocus.bind(a),a.endFocus=a.endFocus.bind(a),a.directionKeys={ArrowUp:"up",KeyW:"up",ArrowRight:"right",KeyD:"right",ArrowDown:"down",KeyS:"down",ArrowLeft:"left",KeyA:"left"},a.statIncreaseKeys={KeyV:"bVitality",KeyB:"bDurability",KeyN:"bStrength",KeyM:"bAgility"},a.consumeDigits=["1","2","3","4","5","6","7","8"],a.state={boardSize:120,tileSize:32,wall:20,floor:40,gameLevel:1,levels:10,bgLevelProcessed:0,itemLevelProcessed:0,moveCount:0,levelUpCount:1,hero:"",heroIcon:null,heroFacing:"",overlayMode:"hero-selection-overlay",gameOver:!1,gameMuted:!1,playerArr:[],bgArr:[],itemArr:[],enemyArr:[],floorCoords:[],inventory:{},interactItem:{count:0,type:"",item:{},source:{}},portalObjective:{coord:[],discovered:!1},useStatPoint:{count:0,type:"",item:{},source:{}},increasedStat:{count:0,type:"",stat:"",quant:0},quickConsume:{count:0,num:0},enemyAttack:{count:0,roundCount:0,spawnIndex:0,stats:{},source:{}},exchangeAttacks:{count:0,spawnIndex:0,attacks:[]},enemyDead:{count:0,spawnIndex:0,coord:[],source:{},level:0,experience:0,gold:0},itemPaletteArrMap:{},itemPalettes:{},enemyPalettes:{},playerPalettes:{}},a}return _inherits(t,e),_createClass(t,[{key:"resetGame",value:function(){this.setState({gameLevel:1,bgLevelProcessed:0,hero:"",heroIcon:null,heroFacing:"",playerPalettes:{},moveCount:0,levelUpCount:1,gameOver:!1,inventory:{},playerArr:[],bgArr:[],itemArr:[],floorCoords:[],itemPalettes:{},itemPaletteArrMap:{},interactItem:{count:0,type:"",item:{},source:{}},useStatPoint:{count:0,type:"",item:{},source:{}},increasedStat:{count:0,type:"",stat:"",quant:0},quickConsume:{count:0,num:0},enemyArr:[],enemyPalettes:{},enemyAttack:{count:0,roundCount:0,spawnIndex:0,stats:{},source:{}},exchangeAttacks:{count:0,spawnIndex:0,attacks:[]},enemyDead:{count:0,spawnIndex:0,coord:[],source:{},level:0,experience:0,gold:0}})}},{key:"toggleMute",value:function(){this.setState({gameMuted:!this.state.gameMuted})}},{key:"updateGameClassState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState(e)}},{key:"pickupItem",value:function(e,t,a){var n=Object.assign({},this.state.itemPaletteArrMap[""+t]),r=Object.assign({},this.state.inventory),o=[].concat(_toConsumableArray(this.state.itemArr)),i=this.state.playerArr,s={},l=Object.assign({},this.state.interactItem),c="";"openChest"!==n.type&&(r[n.name]?r[n.name].count+=1:(n.count=1,n.equipped=!1,r[n.name]=n),["consumable","gold"].includes(n.type)?o[e[0]][e[1]]=0:o[e[0]][e[1]]=chestConsumables.openChest.itemArrVal,l.count+=1,l.type="pickup",l.item=n,s={itemArr:o,inventory:r,interactItem:l,moveCount:a}),c=e[0]<i[0]?"up":e[0]>i[0]?"down":e[1]<i[1]?"left":"right",this.state.heroFacing!==c&&(s.heroFacing=c),s.playerArr=e,this.setState(s)}},{key:"handleKeyDown",value:function(e){if("off"===this.state.overlayMode&&!e.nativeEvent.repeat){var t=e.nativeEvent.code,a=e.nativeEvent.key,n=this.state,r=n.boardSize,o=n.floor,i=n.levels,s=n.playerArr,l=n.bgArr,c=n.itemArr,u=n.itemPaletteArrMap,p=n.enemyArr,m=n.heroFacing,h=this.state,y=h.gameLevel,d=h.moveCount,b={},g="",f=0,v=0;"KeyK"===t&&console.log(s,this.state.portalObjective),this.directionKeys[t]?(d++,g=this.directionKeys[t],f="up"===g?s[0]-1:"down"===g?s[0]+1:s[0],v="right"===g?s[1]+1:"left"===g?s[1]-1:s[1],f>=0&&f<r&&v>=0&&v<r&&l[f][v]>o&&!p[f][v]?c[f][v]?this.pickupItem([f,v],c[f][v],d):(b.playerArr=[f,v],b.moveCount=d,m!==g&&(b.heroFacing=g),this.setState(b)):c[f][v]&&"Active Portal"===u[""+c[f][v]].name?y<i?this.setState({gameLevel:y+1}):(console.log("VICTORY!!!"),this.setState({gameOver:!0,overlayMode:"game-win-overlay"})):p[f][v]&&"merchant"===p[f][v].type?this.setState({overlayMode:"merchant-overlay"}):(b.moveCount=d,m!==g&&(b.heroFacing=g),this.setState(b))):"KeyI"===t||"KeyE"===t?this.setState({overlayMode:"inv-overlay"}):"KeyH"===t?this.setState({overlayMode:"help-overlay"}):this.consumeDigits.includes(a)?this.setState({quickConsume:{count:this.state.quickConsume.count+1,num:t.slice(-1)}}):this.statIncreaseKeys[t]?this.setState({useStatPoint:{count:this.state.useStatPoint.count+1,stat:this.statIncreaseKeys[t]}}):"KeyQ"!==t&&"KeyP"!==t||this.toggleMute()}}},{key:"focus",value:function(){ReactDOM.findDOMNode(this).focus()}},{key:"maintainFocus",value:function(){var e=this;this.focus(),this.focusID=setInterval(function(){return e.focus()},250)}},{key:"endFocus",value:function(){clearInterval(this.focusID)}},{key:"componentDidMount",value:function(){"off"===this.state.overlayMode&&this.maintainFocus()}},{key:"componentWillUpdate",value:function(e,t){this.state.overlayMode!==t.overlayMode&&("off"===t.overlayMode?this.maintainFocus():this.endFocus())}},{key:"componentDidUpdate",value:function(e,t){var a=this;this.state.gameOver&&this.resetGame(),this.state.hero&&this.state.heroIcon&&"hero-selection-overlay"===this.state.overlayMode&&setTimeout(function(){a.setState({overlayMode:"off"})},1e3)}},{key:"render",value:function(){var e=this.state.gameOver;return React.createElement("div",{className:"game",tabIndex:"0",onKeyDown:this.handleKeyDown},e?null:React.createElement(GameSounds,{gameLevel:this.state.gameLevel,levels:this.state.levels,levelUpCount:this.state.levelUpCount,overlayMode:this.state.overlayMode,gameOver:this.state.gameOver,gameMuted:this.state.gameMuted,interactItem:this.state.interactItem,increasedStat:this.state.increasedStat,exchangeAttacks:this.state.exchangeAttacks,enemyDead:this.state.enemyDead}),React.createElement("div",{className:"game-display"},React.createElement("div",{className:"col-lft"},e?null:React.createElement(GameLevel,{gameLevel:this.state.gameLevel}),e?null:React.createElement(Hero,{tileSize:this.state.tileSize,hero:this.state.hero,heroIcon:this.state.heroIcon,gameOver:this.state.gameOver,inventory:this.state.inventory,interactItem:this.state.interactItem,useStatPoint:this.state.useStatPoint,increasedStat:this.state.increasedStat,enemyAttack:this.state.enemyAttack,exchangeAttacks:this.state.exchangeAttacks,enemyDead:this.state.enemyDead,itemPalettes:this.state.itemPalettes,updateGameClassState:this.updateGameClassState})),React.createElement("div",{className:"col-mid"},React.createElement("div",{className:"title"},React.createElement("img",{src:"img/gui/CrimsonQuestTitle.png"})),e?null:React.createElement(GameStage,{boardSize:this.state.boardSize,tileSize:this.state.tileSize,floor:this.state.floor,gameLevel:this.state.gameLevel,levels:this.state.levels,bgLevelProcessed:this.state.bgLevelProcessed,hero:this.state.hero,heroFacing:this.state.heroFacing,overlayMode:this.state.overlayMode,playerArr:this.state.playerArr,bgArr:this.state.bgArr,itemArr:this.state.itemArr,enemyArr:this.state.enemyArr,floorCoords:this.state.floorCoords,inventory:this.state.inventory,interactItem:this.state.interactItem,portalObjective:this.state.portalObjective,enemyDead:this.state.enemyDead,itemPaletteArrMap:this.state.itemPaletteArrMap,itemPalettes:this.state.itemPalettes,enemyPalettes:this.state.enemyPalettes,playerPalettes:this.state.playerPalettes,toggleMute:this.toggleMute,updateGameClassState:this.updateGameClassState}),e?null:React.createElement(ConsumableItems,{tileSize:this.state.tileSize,inventory:this.state.inventory,interactItem:this.state.interactItem,quickConsume:this.state.quickConsume,itemPalettes:this.state.itemPalettes,updateGameClassState:this.updateGameClassState})),React.createElement("div",{className:"col-rgt"},e?null:React.createElement(CurrentObjective,{gameLevel:this.state.gameLevel,enemyDead:this.state.enemyDead}),e?null:React.createElement(EnemyManager,{tileSize:this.state.tileSize,floor:this.state.floor,gameLevel:this.state.gameLevel,itemLevelProcessed:this.state.itemLevelProcessed,moveCount:this.state.moveCount,playerArr:this.state.playerArr,bgArr:this.state.bgArr,enemyArr:this.state.enemyArr,floorCoords:this.state.floorCoords,portalObjective:this.state.portalObjective,enemyAttack:this.state.enemyAttack,exchangeAttacks:this.state.exchangeAttacks,enemyDead:this.state.enemyDead,enemyPalettes:this.state.enemyPalettes,updateGameClassState:this.updateGameClassState}),e?null:React.createElement(ActivityLog,{gameLevel:this.state.gameLevel,levelUpCount:this.state.levelUpCount,interactItem:this.state.interactItem,increasedStat:this.state.increasedStat,exchangeAttacks:this.state.exchangeAttacks,enemyDead:this.state.enemyDead}),e?null:React.createElement(GameTips,null))))}}]),t}(React.Component),PageHeader=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return React.createElement("div",{className:"pg-header"},React.createElement("h1",null,"CrimsonQuest"))}}]),t}(React.Component),PageFooter=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return React.createElement("div",{className:"pg-footer"},React.createElement("span",null,"© 2017 Isaac Burbank."),React.createElement("span",null," ",React.createElement("a",{href:"https://github.com/IMBurbank/crimson-quest/tree/master",target:"_blank"},"Click here")," for details and credits."))}}]),t}(React.Component),App=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{className:"pg"},React.createElement("div",{className:"pg-content"},React.createElement(Game,null)),React.createElement(PageFooter,null))}}]),t}(React.Component);ReactDOM.render(React.createElement(App,null),document.getElementById("root"));